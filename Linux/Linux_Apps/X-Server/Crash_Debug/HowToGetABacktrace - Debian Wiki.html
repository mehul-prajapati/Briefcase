<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
<link rel="shortcut icon" href="https://wiki.debian.org/htdocs/favicon.ico">
<script type="text/javascript" src="HowToGetABacktrace%20-%20Debian%20Wiki_files/bugstatus.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="index,nofollow">

<title>HowToGetABacktrace - Debian Wiki</title>
<script type="text/javascript" src="HowToGetABacktrace%20-%20Debian%20Wiki_files/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="HowToGetABacktrace%20-%20Debian%20Wiki_files/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="HowToGetABacktrace%20-%20Debian%20Wiki_files/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="HowToGetABacktrace%20-%20Debian%20Wiki_files/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="HowToGetABacktrace%20-%20Debian%20Wiki_files/projection.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="HowToGetABacktrace%20-%20Debian%20Wiki_files/debian-wiki-1.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/htdocs/debwiki/css/msie.css">
<![endif]-->


<link rel="alternate" title="Debian Wiki: HowToGetABacktrace" href="https://wiki.debian.org/HowToGetABacktrace?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=HowToGetABacktrace&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="https://wiki.debian.org/FrontPage">
<link rel="Alternate" title="Wiki Markup" href="https://wiki.debian.org/HowToGetABacktrace?action=raw">
<link rel="Alternate" media="print" title="Print View" href="https://wiki.debian.org/HowToGetABacktrace?action=print">
<link rel="Search" href="https://wiki.debian.org/FindPage">
<link rel="Index" href="https://wiki.debian.org/TitleIndex">
<link rel="Glossary" href="https://wiki.debian.org/WordIndex">
<link rel="Help" href="https://wiki.debian.org/HelpOnFormatting">
</head>

<body dir="ltr" lang="en">
<div id="logo"><a href="http://www.debian.org/" title="Debian Homepage"><img src="HowToGetABacktrace%20-%20Debian%20Wiki_files/openlogo-50.png" alt="Debian" height="61" width="50"></a></div>
<div id="header">
<div id="wikisection">
<p class="section"><a href="https://wiki.debian.org/" title="Debian Wiki Homepage">Wiki</a></p>
<div id="username"><a href="https://wiki.debian.org/HowToGetABacktrace?action=login" id="login" rel="nofollow">Login</a></div>
</div>
<div id="navbar">

<ul id="navibar">
<li class="wikilink"><a href="https://wiki.debian.org/FrontPage">FrontPage</a></li><li class="wikilink"><a href="https://wiki.debian.org/RecentChanges">RecentChanges</a></li><li class="wikilink"><a href="https://wiki.debian.org/FindPage">FindPage</a></li><li class="wikilink"><a href="https://wiki.debian.org/HelpContents">HelpContents</a></li><li class="current"><a href="https://wiki.debian.org/HowToGetABacktrace">HowToGetABacktrace</a></li>
</ul>

</div>

<form id="searchform" method="get" action="/HowToGetABacktrace">
<div>
<input name="action" value="fullsearch" type="hidden">
<input name="context" value="180" type="hidden">
<label style="display: none;" for="searchinput">Search:</label>
<input class="disabled" id="searchinput" name="value" value="Search" size="20" onfocus="searchFocus(this)" onblur="searchBlur(this)" onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search" type="text">
<input disabled="disabled" id="titlesearch" name="titlesearch" value="Titles" alt="Search Titles" type="submit">
<input disabled="disabled" id="fullsearch" name="fullsearch" value="Text" alt="Search Full Text" type="submit">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<div id="logo"><a href="http://www.debian.org/" title="Debian Homepage"><img src="HowToGetABacktrace%20-%20Debian%20Wiki_files/openlogo-50.png" alt="Debian" height="61" width="50"></a></div>

<div id="breadcrumbs"><a href="https://wiki.debian.org/" title="Debian Wiki Homepage">Wiki</a><span class="sep">/</span>

</div>

<ul class="editbar"><li><a href="https://wiki.debian.org/HowToGetABacktrace?action=login" id="login-1" rel="nofollow">Login</a></li><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onclick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="https://wiki.debian.org/HowToGetABacktrace?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="https://wiki.debian.org/HowToGetABacktrace?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="/HowToGetABacktrace">
<div>
    
    <select name="action" onchange="if ((this.selectedIndex != 0) &amp;&amp;
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option selected="selected" value="show">More Actions:</option><option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="RenderAsDocbook">Render as Docbook</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="RenamePage" disabled="disabled" class="disabled">Rename Page</option>
<option value="DeletePage" disabled="disabled" class="disabled">Delete Page</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="show" disabled="disabled" class="disabled">Subscribe User</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="show" disabled="disabled" class="disabled">Remove Spam</option>
<option value="show" disabled="disabled" class="disabled">Revert to this revision</option>
<option value="PackagePages">Package Pages</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="Load">Load</option>
<option value="Save">Save</option>
<option value="SlideShow">SlideShow</option>
    </select>
    
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<h1 id="locationline">


<ul id="pagelocation">
<li><a class="backlink" href="https://wiki.debian.org/HowToGetABacktrace?action=fullsearch&amp;context=180&amp;value=linkto%3A%22HowToGetABacktrace%22" rel="nofollow" title="Click to do a full-text search for this title">HowToGetABacktrace</a></li>
</ul>

</h1>
</div>

<div id="page" dir="ltr" lang="en">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867"><small><a href="https://wiki.debian.org/DebianWiki/EditorGuide#translation">Translation(s)</a>: English - <a href="https://wiki.debian.org/ru/HowToGetABacktrace">Русский</a> </small> <span class="anchor" id="line-4"></span></p><hr><p class="line874"> <span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span></p><p class="line867"></p><div class="table-of-contents"><p class="table-of-contents-heading">Contents</p><ol><li>
<a href="#How_To_Get_a_Meaningful_Backtrace">How To Get a Meaningful Backtrace</a><ol><li>
<a href="#Installing_the_debugging_symbols">Installing the debugging symbols</a></li><li>
<a href="#Rebuilding_the_package_you.2BIBk-re_debugging">Rebuilding the package you’re debugging</a></li><li>
<a href="#Running_gdb">Running gdb</a></li><li>
<a href="#Advanced_gdb_commands">Advanced gdb commands</a></li><li>
<a href="#Debugging_X_Errors">Debugging X Errors</a></li><li>
<a href="#Other_Helpful_Links">Other Helpful Links</a></li></ol></li></ol></div> <span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><p class="line867">
</p><h2 id="How_To_Get_a_Meaningful_Backtrace">How To Get a Meaningful Backtrace</h2>
<span class="anchor" id="line-9"></span><p class="line862">This page 
will attempt to explain how to get a meaningful debugging backtrace from
 a reproducible program crash. For this example, we will install the 
package with debugging symbols for "hello" or if this is not available 
rebuild &amp; install the "hello" package so that we keep debugging 
information.  <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span></p><p class="line874">For
 reference, a "#" at the beginning of a line means that what follows is a
 command that has to be executed as root (or sudo). A "$" at the 
beginning means that what follows is a command that should be executed 
as your normal user. A "(gdb)" at the beginning means that you should be
 typing the rest of the command line at the gdb (GNU Debugger) prompt. <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span></p><p class="line867"><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span></p><pre><span class="anchor" id="line-1"></span> # apt-get install gdb</pre><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><p class="line867">
</p><h3 id="Installing_the_debugging_symbols">Installing the debugging symbols</h3>
<span class="anchor" id="line-18"></span><p class="line862">To see if the package you’re trying to debug includes a -dbg package (e.g. for the <em>hello</em> source package, a <em>hello-dbg</em> package exists), search for it in your package manager. On the command line you can use the following command. <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span></p><pre><span class="anchor" id="line-1-1"></span> $ apt-cache search hello | grep dbg
<span class="anchor" id="line-2"></span> p   hello-dbg            - hello debug symbols</pre><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><p class="line862">If
 nothing is returned you have to rebuild the package as explained in the
 next section (or, especially if you are the maintainer of the package, 
modify the package to always build a <a href="https://wiki.debian.org/DebugPackage">DebugPackage</a>). If an appropriate package was found you should just be able to install the appropriate -dbg package for example with <span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span></p><pre><span class="anchor" id="line-1-2"></span> # apt-get install hello-dbg</pre><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><p class="line874">and skip the rebuilding process in the following instructions and go straight to running gdb. <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span></p><p class="line867">
</p><h3 id="Rebuilding_the_package_you.2BIBk-re_debugging">Rebuilding the package you’re debugging</h3>
<span class="anchor" id="line-32"></span><p class="line867"><em>You may skip this section if you were able to install the necessary -dbg package(s) from the previous section.</em> <span class="anchor" id="line-33"></span></p><ul><li><p class="line862">Install
 the basic development packages and the build-dependencies for the 
package we want to rebuild. Note that you can skip the rebuilding part 
and go straight to running gdb, but it is unlikely that you will get a 
useful backtrace. (If the build-dep line fails, check you have deb-src 
lines in /etc/apt/sources.list.) <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span></p><pre><span class="anchor" id="line-1-3"></span> # apt-get install build-essential fakeroot gdb
<span class="anchor" id="line-2-1"></span> # apt-get build-dep hello</pre><span class="anchor" id="line-37"></span></li><li><p class="line862">Download &amp; rebuild our package from source, keeping debugging symbols<span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span></p><pre><span class="anchor" id="line-1-4"></span> $ DEB_BUILD_OPTIONS="nostrip noopt" fakeroot apt-get -b source hello</pre><span class="anchor" id="line-40"></span></li><li><p class="line862">Install
 our newly built package(s). There may be multiple .deb packages 
generated, so make sure to install only the ones you want. In this 
example, the .deb generated was called hello_2.1.1-4_i386.deb.<span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span></p><pre><span class="anchor" id="line-1-5"></span> # dpkg -i hello_2.1.1-4_i386.deb</pre><span class="anchor" id="line-43"></span></li><li><p class="line862">You
 can ensure the binaries installed from your .deb have debugging symbols
 with the 'file' command, or with gdb itself (see below).<span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span></p><pre><span class="anchor" id="line-1-6"></span> $ file /usr/bin/hello # output should contain "not stripped"</pre><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span></li></ul><p class="line867">
</p><h3 id="Running_gdb">Running gdb</h3>
<span class="anchor" id="line-48"></span><ul><li><p class="line862">Now run your program as follows, replacing "[--args]" with any arguments you want to run the program with:<span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span></p><pre><span class="anchor" id="line-1-7"></span> $ gdb hello
<span class="anchor" id="line-2-2"></span> ... gdb loads ...
<span class="anchor" id="line-3"></span> (gdb) set pagination 0
<span class="anchor" id="line-4"></span> (gdb) run [--args]
<span class="anchor" id="line-5"></span> ... hello loads...</pre><span class="anchor" id="line-55"></span></li><li>Then try to reproduce your crash. If you’re lucky, a crash will occur and you’ll be dropped back to the gdb prompt.  <span class="anchor" id="line-56"></span></li><li>If
 you are not so lucky to get a crash but instead get a freeze, you can 
still get gdb prompt by pressing CTRL-C in the terminal running gdb. <span class="anchor" id="line-57"></span></li><li><p class="line862">At that point, you can run:<span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span></p><pre><span class="anchor" id="line-1-8"></span> (gdb) bt</pre><span class="anchor" id="line-60"></span></li><li><p class="line862">You’ll then get a lot of output, which you can then copy &amp; paste to a bug followup e-mail or other bug reporting tool. <span class="anchor" id="line-61"></span></p></li><li><p class="line862">When you’re done with gdb, you can just run:<span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span></p><pre><span class="anchor" id="line-1-9"></span> (gdb) quit</pre><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span></li></ul><p class="line874">If
 the problem seems to be in a major library such as libc6, xlibs, or 
libgtk2.0-0, you’ll want to install the appropriate -dbg package (e.g. 
libc6-dbg in the case of libc6) and then run the problematic program 
again under gdb. <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span></p><p class="line862">Often,
 you will see a backtrace where one or more of the top lines is in 
malloc() or g_malloc(). When this happens, chances are your backtrace 
isn’t very useful. The easiest way to find some useful information is to
 set the environment variable MALLOC_CHECK_ to a value of 2. You can do 
this while running gdb by doing this:<span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span></p><pre><span class="anchor" id="line-1-10"></span> $ MALLOC_CHECK_=2 gdb hello</pre><span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><p class="line867">
</p><h3 id="Advanced_gdb_commands">Advanced gdb commands</h3>
<span class="anchor" id="line-72"></span><ul><li><p class="line862">If the program you’re backtracing is multi-threaded, you might want to get a backtrace for all threads:<span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span></p><pre><span class="anchor" id="line-1-11"></span> (gdb) thread apply all bt</pre><span class="anchor" id="line-75"></span></li><li><p class="line862">Another thing which is quite helpful to report is what variables were set locally at each point in the stack:<span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span></p><pre><span class="anchor" id="line-1-12"></span> (gdb) bt full</pre><span class="anchor" id="line-78"></span></li><li><p class="line862">You might want to report the output of the combination of the preceding options:<span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span></p><pre><span class="anchor" id="line-1-13"></span> (gdb) thread apply all bt full</pre><span class="anchor" id="line-81"></span></li><li><p class="line862">And if this is too much irrelevant output, you might want to keep only a few calls, such as the top 10:<span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span></p><pre><span class="anchor" id="line-1-14"></span> (gdb) thread apply all bt full 10</pre><span class="anchor" id="line-84"></span></li><li><p class="line862">If you have a large backtrace, you can log gdb output to a file (the default is gdb.txt):<span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span></p><pre><span class="anchor" id="line-1-15"></span> (gdb) set logging on</pre><span class="anchor" id="line-87"></span></li><li><p class="line862">To check you have debugging symbols in your binary:<span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span></p><pre><span class="anchor" id="line-1-16"></span> $ gdb
<span class="anchor" id="line-2-3"></span>  (gdb) symbol-file /usr/bin/hello
<span class="anchor" id="line-3-1"></span>
<span class="anchor" id="line-4-1"></span> # you should see something like this:
<span class="anchor" id="line-5-1"></span>  Reading symbols from /usr/bin/hello ... done
<span class="anchor" id="line-6"></span>  Using host libthread_db library "/lib/tls/i686/cmov/libthread_db.so.1".
<span class="anchor" id="line-7"></span>  (gdb)
<span class="anchor" id="line-8"></span>
<span class="anchor" id="line-9"></span> # NB you should _not_ see
<span class="anchor" id="line-10"></span>  Reading symbols from /usr/bin/hello...(no debugging symbols found)...done</pre><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span></li></ul><p class="line867">
</p><h3 id="Debugging_X_Errors">Debugging X Errors</h3>
<span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><p class="line874">If a GTK program has received an X error; i.e. you see a message of the form: <span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span></p><p class="line867"><span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span></p><pre><span class="anchor" id="line-1-17"></span>The program 'preview1' received an X Window System error.</pre><span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><p class="line862">then you can try running the program with <tt class="backtick">--sync</tt>, and break on the <tt class="backtick">gdk_x_error</tt> function in order to obtain a backtrace, thus: <span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span></p><pre><span class="anchor" id="line-1-18"></span> (gdb) break gdk_x_error
<span class="anchor" id="line-2-4"></span> (gdb) run --sync</pre><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><p class="line867">
</p><h3 id="Other_Helpful_Links">Other Helpful Links</h3>
<span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><ul><li><p class="line891"><a class="http" href="http://wiki.debian.org/XStrikeForce/XserverDebugging">Debugging the Xorg server</a> <span class="anchor" id="line-118"></span></p></li><li><p class="line891"><a class="http" href="http://wiki.ubuntu.com/Backtrace">Ubuntu Backtrace page</a> <span class="anchor" id="line-119"></span><span class="anchor" id="line-120"></span></p></li></ul><p class="line862">--<a href="https://wiki.debian.org/AriPollak">AriPollak</a> and <a class="nonexistent" href="https://wiki.debian.org/LoicMinier">?</a>LoicMinier <span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span></p><p class="line867"><a href="https://wiki.debian.org/CategoryDebugging">CategoryDebugging</a> <span class="anchor" id="line-123"></span><span class="anchor" id="bottom"></span></p></div><div id="pagebottom"></div>
</div>


<div id="footer">
<p id="pageinfo" class="info" dir="ltr" lang="en">HowToGetABacktrace  (last edited 2014-04-08 19:45:40 by <span title="Solveig"><a class="nonexistent" href="https://wiki.debian.org/Solveig" title="Solveig">?</a>Solveig</span>)</p>

<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li><li>Debian Wiki <a href="https://wiki.debian.org/Teams/DebianWiki">team</a>, <a href="http://bugs.debian.org/wiki.debian.org">bugs</a> and <a href="http://git.debian.org/?p=collab-maint/wiki.debian.org.git;a=summary">config</a> available.</li><li>Hosting provided by <a href="http://www.dg-i.net/">Dembach Goo Informatik GmbH &amp; Co KG</a></li>
</ul>


</div>



</body></html>