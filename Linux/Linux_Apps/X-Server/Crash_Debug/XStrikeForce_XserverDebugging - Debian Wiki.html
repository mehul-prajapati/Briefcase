<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
<link rel="shortcut icon" href="https://wiki.debian.org/htdocs/favicon.ico">
<script type="text/javascript" src="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/bugstatus.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="index,nofollow">

<title>XStrikeForce/XserverDebugging - Debian Wiki</title>
<script type="text/javascript" src="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/projection.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/debian-wiki-1.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/htdocs/debwiki/css/msie.css">
<![endif]-->


<link rel="alternate" title="Debian Wiki: XStrikeForce/XserverDebugging" href="https://wiki.debian.org/XStrikeForce/XserverDebugging?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=XStrikeForce%2FXserverDebugging&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="https://wiki.debian.org/FrontPage">
<link rel="Alternate" title="Wiki Markup" href="https://wiki.debian.org/XStrikeForce/XserverDebugging?action=raw">
<link rel="Alternate" media="print" title="Print View" href="https://wiki.debian.org/XStrikeForce/XserverDebugging?action=print">
<link rel="Up" href="https://wiki.debian.org/XStrikeForce">
<link rel="Search" href="https://wiki.debian.org/FindPage">
<link rel="Index" href="https://wiki.debian.org/TitleIndex">
<link rel="Glossary" href="https://wiki.debian.org/WordIndex">
<link rel="Help" href="https://wiki.debian.org/HelpOnFormatting">
</head>

<body dir="ltr" lang="en">
<div id="logo"><a href="http://www.debian.org/" title="Debian Homepage"><img src="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/openlogo-50.png" alt="Debian" height="61" width="50"></a></div>
<div id="header">
<div id="wikisection">
<p class="section"><a href="https://wiki.debian.org/" title="Debian Wiki Homepage">Wiki</a></p>
<div id="username"><a href="https://wiki.debian.org/XStrikeForce/XserverDebugging?action=login" id="login" rel="nofollow">Login</a></div>
</div>
<div id="navbar">

<ul id="navibar">
<li class="wikilink"><a href="https://wiki.debian.org/FrontPage">FrontPage</a></li><li class="wikilink"><a href="https://wiki.debian.org/RecentChanges">RecentChanges</a></li><li class="wikilink"><a href="https://wiki.debian.org/FindPage">FindPage</a></li><li class="wikilink"><a href="https://wiki.debian.org/HelpContents">HelpContents</a></li><li class="current"><a href="https://wiki.debian.org/XStrikeForce/XserverDebugging">XserverDebugging</a></li>
</ul>

</div>

<form id="searchform" method="get" action="/XStrikeForce/XserverDebugging">
<div>
<input name="action" value="fullsearch" type="hidden">
<input name="context" value="180" type="hidden">
<label style="display: none;" for="searchinput">Search:</label>
<input class="disabled" id="searchinput" name="value" value="Search" size="20" onfocus="searchFocus(this)" onblur="searchBlur(this)" onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search" type="text">
<input disabled="disabled" id="titlesearch" name="titlesearch" value="Titles" alt="Search Titles" type="submit">
<input disabled="disabled" id="fullsearch" name="fullsearch" value="Text" alt="Search Full Text" type="submit">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<div id="logo"><a href="http://www.debian.org/" title="Debian Homepage"><img src="XStrikeForce_XserverDebugging%20-%20Debian%20Wiki_files/openlogo-50.png" alt="Debian" height="61" width="50"></a></div>

<div id="breadcrumbs"><a href="https://wiki.debian.org/" title="Debian Wiki Homepage">Wiki</a><span class="sep">/</span>

</div>

<ul class="editbar"><li><a href="https://wiki.debian.org/XStrikeForce/XserverDebugging?action=login" id="login-1" rel="nofollow">Login</a></li><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onclick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="https://wiki.debian.org/XStrikeForce/XserverDebugging?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="https://wiki.debian.org/XStrikeForce/XserverDebugging?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="/XStrikeForce/XserverDebugging">
<div>
    
    <select name="action" onchange="if ((this.selectedIndex != 0) &amp;&amp;
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option selected="selected" value="show">More Actions:</option><option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="RenderAsDocbook">Render as Docbook</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="RenamePage" disabled="disabled" class="disabled">Rename Page</option>
<option value="DeletePage" disabled="disabled" class="disabled">Delete Page</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="show" disabled="disabled" class="disabled">Subscribe User</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="show" disabled="disabled" class="disabled">Remove Spam</option>
<option value="show" disabled="disabled" class="disabled">Revert to this revision</option>
<option value="PackagePages">Package Pages</option>
<option value="show" disabled="disabled" class="disabled">------------------------</option>
<option value="Load">Load</option>
<option value="Save">Save</option>
<option value="SlideShow">SlideShow</option>
    </select>
    
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<h1 id="locationline">


<ul id="pagelocation">
<li><a href="https://wiki.debian.org/XStrikeForce">XStrikeForce</a></li><li><a class="backlink" href="https://wiki.debian.org/XStrikeForce/XserverDebugging?action=fullsearch&amp;context=180&amp;value=linkto%3A%22XStrikeForce%2FXserverDebugging%22" rel="nofollow" title="Click to do a full-text search for this title">XserverDebugging</a></li>
</ul>

</h1>
</div>

<div id="page" dir="ltr" lang="en">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line867"></p><div class="table-of-contents"><p class="table-of-contents-heading">Contents</p><ol><li>
<a href="#Reporting_Xorg_server_crashes">Reporting Xorg server crashes</a><ol><li>
<a href="#Which_debugging_packages_do_I_need.3F">Which debugging packages do I need?</a></li><li>
<a href="#Obtaining_a_backtrace_with_gdb">Obtaining a backtrace with gdb</a></li><li>
<a href="#Obtaining_a_backtrace_from_a_coredump">Obtaining a backtrace from a coredump</a></li><li>
<a href="#Xorg_real_debugging">Xorg real debugging</a></li></ol></li></ol></div> <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867">
</p><h1 id="Reporting_Xorg_server_crashes">Reporting Xorg server crashes</h1>
<span class="anchor" id="line-4"></span><p class="line874">The reportbug
 application sends most of the needed information (reportbug-ng should 
be avoided for now since it does NOT do so). Please do not remove 
anything, it is always better to have useless information than to miss 
useful information. If for some reason, this information did not get 
included, you can generate it with <span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span></p><pre><span class="anchor" id="line-1"></span>/usr/share/bug/xserver-xorg-core/script 3&gt;&amp;1</pre><span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line874">This
 command should be run as root. Be careful with redirections if you're 
using sudo. For instance, sending the output in a file would be <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span></p><pre><span class="anchor" id="line-1-1"></span>sudo bash -c "/usr/share/bug/xserver-xorg-core/script 3&gt;&amp;1" &gt; file</pre><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><p class="line862">The most important part is Xorg log (stored in <tt class="backtick">/var/log/Xorg.0.log</tt> for display 0). Every time the X server on display 0 is restarted, the log of the previous session is renamed into <tt class="backtick">Xorg.0.log.old</tt>. So you have to make sure you include the latter if you restarted X since the crash. <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span></p><p class="line874">It
 is often better to not use xdm|gdm|kdm when debugging the X server 
since they will try to restart X several times after a failure. Stopping
 them and starting X by hand is often better: <span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span></p><pre><span class="anchor" id="line-1-2"></span>invoke-rc.d kdm|gdm|xdm stop # as root
<span class="anchor" id="line-2"></span>startx [/path/to/client/if/any] # as normal user</pre><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><p class="line874">To get more info on reporting bugs, please look at  <span class="anchor" id="line-23"></span><a class="http" href="http://wiki.debian.org/reportbug">Reporting Bugs in Debian</a>. <span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span></p><p class="line867">
</p><h2 id="Which_debugging_packages_do_I_need.3F">Which debugging packages do I need?</h2>
<span class="anchor" id="line-26"></span><p class="line874">Apart from 
the log and configuration, debugging a crash of the server requires a 
detailed backtrace so that developers may know exactly where/when the 
crash occurs. In order to get this valuable info you need debugging 
packages to help gdb translate the backtrace into a very detailed 
backtrace. <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span></p><p class="line862">First, make sure that the <tt class="backtick">xserver-xorg-core-dbg</tt> package is installed. <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span></p><p class="line862">You
 should also install a debugging package for your video driver if it is 
available. For the main video drivers these are the packages <tt class="backtick">xserver-xorg-video-intel-dbg</tt>, <tt class="backtick">xserver-xorg-video-ati-dbg</tt> and <tt class="backtick">xserver-xorg-video-nouveau-dbg</tt>, respectively. <span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span></p><p class="line862">Also, the Mesa/GL libraries might be involved, installing <tt class="backtick">libgl1-mesa-dri-dbg</tt> and <tt class="backtick">libgl1-mesa-glx-dbg</tt> might help too. <span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span></p><p class="line862">If you think you miss some debugging packages, you might want to rebuild one package with debugging enabled, see <a class="http" href="http://wiki.debian.org/HowToGetABacktrace">HowToGetABacktrace</a>. <span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span></p><p class="line867">
</p><h2 id="Obtaining_a_backtrace_with_gdb">Obtaining a backtrace with gdb</h2>
<span class="anchor" id="line-37"></span><p class="line867"><strong>Please read this section entirely before actually trying to attach a gdb</strong> <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span></p><p class="line867"><em>Note that you must have root permissions (either running as root or using sudo) to do the following.</em> Attaching gdb to X server before reproducing the crash might catch a nice backtrace: <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span></p><pre><span class="anchor" id="line-1-3"></span>gdb -p $(pidof X)
<span class="anchor" id="line-2-1"></span>(inside gdb)
<span class="anchor" id="line-3"></span>set logging overwrite on
<span class="anchor" id="line-4"></span>set logging on
<span class="anchor" id="line-5"></span>continue
<span class="anchor" id="line-6"></span>(X server is stopped from when gdb is attached until "continue" is typed)
<span class="anchor" id="line-7"></span>(do whatever caused the problem)
<span class="anchor" id="line-8"></span>bt full
<span class="anchor" id="line-9"></span>set logging off
<span class="anchor" id="line-10"></span>quit</pre><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><p class="line862">After this, you get the gdb output in file <tt class="backtick">gdb.txt</tt> in the directory where you started gdb (this is what the <tt class="backtick">logging</tt>
 commands did, another solution is to copy-paste the output yourself). 
Add all this to your bug report, developers will appreciate it. If the 
backtrace is small, you probably miss several debugging packages, see 
above. <span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span></p><p class="line862">However, <strong>you should NOT do it from a terminal running within X</strong>
 since the crash of the server will kill all X clients, including this 
terminal and the gdb. A possible solution consists of placing gdb in a 
virtual console (for instance, the one you get with Ctrl-Alt-F1). 
However, since the server is involved during the switch between X and 
this console, it might be impossible to switch once the crash occurs, 
making your gdb impossible to reach. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span></p><p class="line862">The <strong>best way is definitely to logon the machine from another machine by ssh</strong> and attach gdb from there. Unfortunately, you need another machine to do so, and ssh access. <span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span></p><p class="line874">Also, note that you might have to tell the server to stop catch signals on crash, it should be done by adding: <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span></p><pre><span class="anchor" id="line-1-4"></span>Option "NoTrapSignals"</pre><span class="anchor" id="line-63"></span><p class="line862">in the <tt class="backtick">ServerLayout</tt> section of your <tt class="backtick">xorg.conf</tt> configuration file. <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span></p><p class="line874">One user reported that the following line worked without ssh: <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span></p><pre><span class="anchor" id="line-1-5"></span># gdb -p $(pidof X) -batch -ex 'handle all nostop' -ex 'handle all pass'
<span class="anchor" id="line-2-2"></span>  -ex 'handle 11 stop' -ex 'cont' -ex 'bt full' -ex 'cont'</pre><span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><p class="line867">
</p><h2 id="Obtaining_a_backtrace_from_a_coredump">Obtaining a backtrace from a coredump</h2>
<span class="anchor" id="line-72"></span><p class="line862">If the above
 solutions are not possible for you or do not work, another way to 
obtain a backtrace is to let the crash generate a coredump, and run gdb 
on it later. Debugging packages are required too (<tt class="backtick">xserver-xorg-core-dbg</tt> and the drivers' ones too, see the relevant section above). <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span></p><p class="line862">The
 command needed to enable core dumps is "ulimit -c unlimited" but this 
should be run before Xorg is run, and in the same session. You could run
 it (as root) on a text console, and then (without leaving the session) 
restart the graphical session (either with <tt class="backtick">startx</tt> or <tt class="backtick">invoke-rc.d&nbsp;kdm|gdm|xdm&nbsp;restart</tt>) or alternatively you can tweak the kdm|gdm|xdm init script to add the ulimit line. <span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span></p><p class="line862">Once core dumps are enabled you will have the one for Xorg on the file <tt class="backtick">/etc/X11/core</tt>. Using gdb, you should have the backtrace info you have to do the following (as root): <span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span></p><pre><span class="anchor" id="line-1-6"></span>cd /etc/X11
<span class="anchor" id="line-2-3"></span>gdb $(which Xorg) core
<span class="anchor" id="line-3-1"></span>(inside gdb)
<span class="anchor" id="line-4-1"></span>set logging overwrite on
<span class="anchor" id="line-5-1"></span>set logging on
<span class="anchor" id="line-6-1"></span>bt full
<span class="anchor" id="line-7-1"></span>set logging off
<span class="anchor" id="line-8-1"></span>quit</pre><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><p class="line862">After this, you get the gdb output in file <tt class="backtick">/etc/X11/gdb.txt</tt>. Add all this to your bug report, developers will appreciate it. <span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span></p><p class="line867">
</p><h2 id="Xorg_real_debugging">Xorg real debugging</h2>
<span class="anchor" id="line-91"></span><p class="line862">The 
explained method hopefully provides info enough to Xorg Maintainers in 
order to know where the problem could be but if you would like to debug 
the Xorg server yourself you could pay attention to <a class="http" href="http://wiki.x.org/wiki/Development/Documentation/ServerDebugging">Xorg Server Debugging</a> <span class="anchor" id="line-92"></span><span class="anchor" id="bottom"></span></p></div><div id="pagebottom"></div>
</div>


<div id="footer">
<p id="pageinfo" class="info" dir="ltr" lang="en">XStrikeForce/XserverDebugging  (last edited 2011-01-07 12:42:58 by <span title="Arthur Marsh"><a class="nonexistent" href="https://wiki.debian.org/Arthur%20Marsh" title="Arthur Marsh">?</a>Arthur Marsh</span>)</p>

<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li><li>Debian Wiki <a href="https://wiki.debian.org/Teams/DebianWiki">team</a>, <a href="http://bugs.debian.org/wiki.debian.org">bugs</a> and <a href="http://git.debian.org/?p=collab-maint/wiki.debian.org.git;a=summary">config</a> available.</li><li>Hosting provided by <a href="http://www.dg-i.net/">Dembach Goo Informatik GmbH &amp; Co KG</a></li>
</ul>


</div>



</body></html>