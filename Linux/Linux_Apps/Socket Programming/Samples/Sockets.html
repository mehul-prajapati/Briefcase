<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><script src="Sockets_files/auth016.js" type="text/javascript"></script><script src="Sockets_files/count.bin" async="true" type="text/javascript"></script><link href="Sockets_files/buttons3.css" type="text/css" rel="stylesheet"><link media="all" href="Sockets_files/widget118.css" type="text/css" rel="stylesheet">
  <title>Sockets</title>
  <link rel="stylesheet" href="Sockets_files/yolinux.css" type="text/css">
  <link rel="canonical" href="http://www.yolinux.com/TUTORIALS/Sockets.html">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="keywords" content="Sockets,programming sockets,C/C++ sockets,C and C++ BSD sockets,sockets class,C programming sockets,C sockets Linux API">
  <meta name="description" content="BSD C language socket API and socket examples. The YoLinux portal covers topics from desktop to servers and from developers to users">
  <meta name="author" content="Greg Ippolito">
  <link type="text/css" rel="stylesheet" href="Sockets_files/shCoreYoLinux.css">
  <link type="text/css" rel="stylesheet" href="Sockets_files/shThemeYoLinux.css">
  <script async="" src="Sockets_files/cbgapi.loaded_1"></script><script async="" src="Sockets_files/cbgapi.loaded_0"></script><script type="text/javascript" async="" src="Sockets_files/quant.js"></script><script src="Sockets_files/widgets.js" async="" type="text/javascript"></script><script type="text/javascript" src="Sockets_files/shCoreYoLinux.js"></script>
  <script type="text/javascript" src="Sockets_files/shBrushCpp.js"></script>
  <script type="text/javascript">
        SyntaxHighlighter.config.clipboardSwf = 'syntaxhighlighter/scripts/clipboard.swf';
        SyntaxHighlighter.all();
  </script>
</head>

<body>
<a name="TOP"></a>
<table width="100%" cellpadding="4">
  <tbody>
    <tr>
      <td valign="top">
      <a href="http://www.yolinux.com/"><img src="Sockets_files/YoLinux_Tutorial_logo.png" alt="Yolinux.com Tutorial" border="none"></a>
      </td>
      <td valign="top">
      <h1>Sockets</h1>
      <h3>Socket programming and the C BSD API</h3>
C and C++ sockets programming with examples of the BSD API on the Linux platform.
      <p>
      </p>
<div align="center">
<iframe class="adframe" allowtransparency="true" marginheight="0" marginwidth="0" style="border:none;width:720;height:90;padding:0;" src="Sockets_files/iframe728x90px-ValueClick.html" width="720" frameborder="0" height="90" scrolling="no">
</iframe>
</div>

      </td>
    </tr>
  </tbody>
</table>

<p>
</p>
<table width="100%">
<tbody>
<tr>
<td valign="top">
<dl>
  <dd>
    <b>Tutorial Table of Contents:</b>
    <ul>
      <li># <a href="#DESCRIPTION">Socket Description</a>
      </li>
      <li># <a href="#API">BSD socket API</a>
      </li>
      <li># <a href="#SERVER">Socket Server</a>
      </li>
      <li># <a href="#CLIENT">Socket Client</a>
      </li>
      <li># <a href="#TEST">Test Socket Client/Server</a>
      </li>
      <li># <a href="#DNS">Name Resolution and Network Information Lookup</a>
      </li>
      <li># <a href="#OPTIONS">Socket Configuration Options</a>
      </li>
      <li># <a href="#AVAILABILITY">Test Socket Availability</a>
      </li>
      <li># <a href="#PORTS">IP Ports</a>
      </li>
      <li># <a href="#ENDIAN">Host and Network Byte Order</a>
      </li>
      <li># <a href="#TIPS">Tips and Best Practices</a>
      </li>
      <li># <a href="#WIN32">Win32 and cross platform considerations</a>
      </li>
      <li># <a href="#MANPAGES">Socket Man Pages</a>
      </li>
    </ul>

  </dd>
</dl>
</td>
<td> <img src="Sockets_files/tux-phone-Ity_w300.gif" alt="Socket Connection 1"> </td>
<td><img src="Sockets_files/SocketLightningBolt.gif" alt="Socket Connection"></td>
<td> <img src="Sockets_files/tux-phone-Ity-mirror_w300.gif" alt="Socket Connection 2"> </td>
</tr>
</tbody>
</table>

<a name="DESCRIPTION"></a>
<!-- Navigation Menu bar -->
<div id="globalNavigation">
<table width="100%" bgcolor="#000000">
<tbody>
<tr bgcolor="#000000">
<td colspan="3">
<form method="post" action="http://www.yolinux.com/cgi-bin/htsearch">
<input name="method" value="all" type="hidden"> 
<input name="format" value="long" type="hidden"> 
<input name="sort" value="score" type="hidden"> 
<input name="config" value="htdig-yolinux" type="hidden"> 
<input name="restrict" value="" type="hidden"> 
<input name="exclude" value="" type="hidden"> 
<label for="search">search</label>
<input size="20" maxlength="80" name="words" id="search" type="text"> 
<input value="Search" type="submit">
</form></td>
<td align="right">
<font size="-1" color="#f7bc33">
<b>
&nbsp;|&nbsp;
<a href="http://www.yolinux.com/" class="menubar" title="YoLinux Home Page">Home Page</a>&nbsp;|&nbsp;
<a href="http://www.yolinux.com/TUTORIALS/" class="menubar" title="YoLinux Web Site Tutorials Index">Linux Tutorials</a>&nbsp;|&nbsp;
<a href="http://www.yolinux.com/YoLinux-Terms.html" class="menubar" title="YoLinux.com terms of use" rel="nofollow">Terms</a>&nbsp;|&nbsp;
<a href="http://www.yolinux.com/privacy.html" class="menubar" title="YoLinux.com privacy policy" rel="nofollow">Privacy Policy</a>&nbsp;|&nbsp;
<a href="http://www.yolinux.com/YoLinux-Advertising.html" class="menubar" title="Advertising rates for YoLinux.com">Advertising</a>&nbsp;|&nbsp;
<a href="http://www.yolinux.com/YoLinuxEmailForm.html" class="menubar" title="Send us an email" rel="nofollow">Contact</a> &nbsp;|&nbsp;
</b>
</font>

</td>
</tr>
</tbody>
</table>
</div>
<!-- End of Navigation menu bar -->

<table class="main" border="0" cellpadding="4" cellspacing="1">
  <tbody>
    <tr class="main">
      <td class="leftcol">
      <p>
      <font size="-1">
      <b>Related YoLinux Tutorials:</b>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/LinuxTutorialC++.html">Linux and C++</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/LinuxTutorialC++Structures.html">C++ Unions &amp; Structures</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/LinuxTutorialC++STL.html">C++ STL</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/CppStlMultiMap.html">C++ STL Map</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/LinuxTutorialC++StringClass.html">C++ String Class</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/C++Singleton.html">C++ Singleton</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/LinuxTutorialC++CodingStyle.html">C++ Coding Style</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/C++XmlBeansxx.html">C++ XML Beans</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/Cpp-DynamicMemory.html">C/C++ Dynamic Memory</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/C++MemoryCorruptionAndMemoryLeaks.html">C++ Memory Corruption</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/C++Signals.html">C/C++ Signal Handling</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/LinuxTutorialC++CGI.html">C++ CGI</a>
      </font></p>
      <p>
      <font size="-1">°<a href="http://www.yolinux.com/TUTORIALS/">YoLinux Tutorials Index</a>
      </font>
      </p>


<hr>
<p>
<!-- BEGIN RICH-MEDIA CODE -->
<script type="text/javascript"><!--
google_ad_client = "pub-8567479315106986";
/* 160x600, YoLinux default */
google_ad_slot = "8947481941";
google_ad_width = 160;
google_ad_height = 600;
//-->
</script>
<script type="text/javascript" src="Sockets_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:160px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:160px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" width="160" frameborder="0" height="600" scrolling="no"></iframe></ins></ins>
</p>
<hr>
<p>
<!-- Ad links -->
<script type="text/javascript"><!-- 
google_ad_client = "pub-8567479315106986";
google_ad_width = 160;
google_ad_height = 90;
google_ad_format = "160x90_0ads_al_s";
google_ad_channel ="";
google_color_border = "FFFFFF";
google_color_bg = "C0C0C0";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "008000";
//-->
</script>
<script type="text/javascript" src="Sockets_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:160px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:160px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;" width="160" frameborder="0" height="90" scrolling="no"></iframe></ins></ins>
</p>
<!-- END CODE -->
<hr>
<p>
<a href="http://yolinux.tradepub.com/">Free Information Technology Magazines and Document Downloads<br><img src="Sockets_files/TradePubMagazines.gif" alt="TradePub link image" border="0"></a>
</p>
<hr>

</td>

<td class="content">
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Description:</td>
    </tr>
  </tbody>
</table>

<p>
Sockets are an inter-process network communication implementation using a
 Internet Protocol (IP) stack on an Ethernet transport.
Sockets are language and protocol independent and available to "C", 
Perl, Python, Ruby and Java (and more) programmers.
The "C" language BSD API is used on Linux, all popular variants of Unix,
 Microsoft Windows (NT,2000,XP,... and later) and even embedded OSs like
 VxWorks. It is by far the most popular implementation of inter-process 
network communication.
</p>
<p>
Sockets allow one process to communicate with another whether it is 
local on the same computer system or remote over the network.
Many other higher level protocols are built upon sockets technology.
</p>
<p>
The sockets API provides many configuration options so we will try and 
cover the socket API components and then give examples of a few 
implementations.
It would be very difficult to cover all variations of its use.
</p>
<p>
</p>
Sockets utilize the following standard protocols:
<dl><dd>
<table border="1" cellpadding="2">
<tbody>
<tr bgcolor="#c0c0c0"><th>Protocol</th><th>Description</th></tr>
<tr><td valign="top">IP</td><td valign="top">Internet Protocol provides network routing  using IP addressing eg 192.168.1.204</td></tr>
<tr><td valign="top">UDP</td><td valign="top">User Datagram Protocol - IP with ports to distinguish among processes running on same host. No data verification.</td></tr>
<tr><td valign="top">TCP</td><td valign="top">Transmission Control 
Protocol - IP with ports to distinguish among processes running on same 
host. Connection oriented, stream transfer, full duplex, reliable with 
data verification.</td></tr>
</tbody>
</table>
</dd></dl>

<p>
<a name="API"></a>
</p>
<p>
</p>
<hr size="5">
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>BSD socket API:</td>
    </tr>
  </tbody>
</table>

<p>
Typically one configures a socket server to which a socket client may 
attach and communicate. 
The IP protocol layer will also require that the domain name or IP 
addresses of the communicating processes be made known as well.
Within the IP protocol it is also important to provide the mechanism 
used: TCP or UDP.
</p>
<p>
The BSD is a "C" programming API. Examples shown are compiled using the GNU C++ compiler on Linux:
</p>
<h3>Basic steps in using a socket:</h3>
<ul>
<li><b>Socket include files:</b>
    <table border="1" cellpadding="4" cellspacing="1">
    <tbody>
    <tr bgcolor="#c0c0c0"><th>Include File</th><th>Description</th></tr>
    <tr><td valign="top">sys/types.h</td><td>Types used in sys/socket.h and netinet/in.h</td></tr>
    <tr><td valign="top">netinet/in.h</td><td>Internet domain address structures and functions</td></tr>
    <tr><td valign="top">netinet/tcp.h</td><td>Socket option macro definitions, TCP headers, enums, etc</td></tr>
    <tr><td valign="top">sys/socket.h</td><td>Structures and functions used for socket API.i <tt>accept(), bind(), connect(), listen(), recv(), send(), setsockopt(), shutdown()</tt>, etc ...</td></tr>
    <tr><td valign="top">netdb.h</td><td>Used for domain/DNS hostname lookup</td></tr>
    <tr><td valign="top">sys/select.h</td><td>Used by the <tt>select(), pselect()</tt> functions and defines <tt>FD_CLR, FD_ISSET, FD_SET, FD_ZERO</tt> macros</td></tr>
    <tr><td valign="top">sys/time.h</td><td><tt>select()</tt> uses argument of type <tt>struct timeval</tt> and <tt>pselect()</tt> uses <tt>struct timespec</tt> defined by this include file.</td></tr>
    <tr><td valign="top">arpa/inet.h</td><td>Definitions for internet operations. Prototypes functions such as <tt>htonl(), htons(), ntohl(), ntohs(), inet_addr(), inet_ntoa()</tt>, etc ...</td></tr>
    <tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=unistd.h">unistd.h</a></td><td>Defines constants and types</td></tr>
    <tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=errno.h">errno.h</a></td><td>Defines sytem error numbers</td></tr>
    </tbody>
    </table>
    <p>
    </p>
</li>
<li><b>Create the socket instance:</b>
    <p>
Open a socket using TCP: Basic declarations and call to "socket".
    </p>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_463334"><div class="bar   "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_463334_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_463334" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;iostream&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include &lt;sys/types.h&gt;&nbsp;&nbsp; // Types used in sys/socket.h and netinet/in.h</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#include &lt;netinet/in.h&gt;&nbsp; // Internet domain address structures and functions</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="preprocessor">#include &lt;sys/socket.h&gt;&nbsp; // Structures and functions used for socket API</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="preprocessor">#include &lt;netdb.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Used for domain/DNS hostname lookup</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="preprocessor">#include &lt;unistd.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="preprocessor">#include &lt;errno.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="keyword bold">using</code> <code class="keyword bold">namespace</code> <code class="plain">std;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="plain">main()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketHandle;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// create socket</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((socketHandle = socket(AF_INET, SOCK_STREAM, IPPROTO_IP)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
Socket function prototype:
<dl><dd>
<tt>int socketHandle = socket(int socket_family, int socket_type, int protocol);
</tt></dd></dl>
Choose socket communications family/domain:
<ul>
<li>Internet IPV4: <tt>AF_INET</tt>
</li>
<li>Internet IPV6: <tt>AF_INET6</tt>
</li>
<li>Unix path name (communicating processes are on the same system): <tt>AF_UNIX</tt>
</li>
</ul>
Choose socket type:
<ul>
<li>TCP: <tt>SOCK_STREAM</tt>
</li>
<li>UDP: <tt>SOCK_DGRAM</tt>
</li>
<li>Raw protocol at network layer: <tt>SOCK_RAW</tt>
</li>
</ul>
Choose socket protocol: (See <tt>/etc/protocols</tt>)
<ul>
<li>Internet Protocol (IP): <tt>0</tt> or <tt>IPPROTO_IP</tt>
</li>
<li>ICMP: <tt>1</tt>
</li>
<li>...
</li>
</ul>
Also see:
<ul>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=socket">socket man page</a>
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=protocols">protocols man page</a>
</li>
</ul>
<p>
</p>
</li>
<li><b>Configure the socket as a client or server:</b>
<p>
Comparison of sequence of BSD API calls:
</p>
<dl><dd>
<table border="1" cellspacing="2">
<tbody>
<tr bgcolor="#a0a0a0"><th>Socket Server</th><th>Socket Client</th></tr>
<tr bgcolor="#c0c0c0"><td>socket()</td><td>socket()</td></tr>
<tr><td>bind()</td><td>gethostbyname()</td></tr>
<tr><td>listen()</td><td><br></td></tr>
<tr><td>accept()</td><td>connect()</td></tr>
<tr bgcolor="#c0c0c0"><td>recv()/send()</td><td>recv()/send()</td></tr>
<tr bgcolor="#c0c0c0"><td>close()</td><td>close()</td></tr>
</tbody>
</table>
</dd></dl>
<p>
This is specific to whether the application is a socket client or a socket server.
</p>
<ul>
<li><b>Socket server:</b>
    <ul>
    <li><b>bind():</b> bind the socket to a local socket address. This assigns a name to the socket.
    </li>
    <li><b>listen():</b> listen for connections on a socket created with
 "socket()" and "bind()" and accept incoming connections. This is used 
for TCP and not UDP.
        Zero is returned on success.
    </li>
    <li><b>accept():</b> accept a connection on a socket. Accept the  
first
       connection  request on the queue of pending connections, create a
 new
       connected socket with mostly the same properties as defined by 
the call to "socket()", and allocate a new file descriptor for the 
socket, which is returned.  
        The newly created socket is no longer in the listening state.
        Note this call blocks until a client connects.
    </li>
    </ul>
<dl>
  <dd>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_892367"><div class="bar   "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_892367_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_892367" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#define MAXHOSTNAME 256</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in socketAddress;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">sysHost[MAXHOSTNAME+1];&nbsp; </code><code class="comments">// Hostname of this computer we are running on</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">hostNamePtr *hPtr;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">portNumber = 8080;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">bzero(&amp;socketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(sockaddr_in));&nbsp; </code><code class="comments">// Clear structure memory</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Get system information</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">gethostname(sysHost, MAXHOSTNAME);&nbsp; </code><code class="comments">// Get the name of this computer we are running on</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((hPtr = gethostbyname(sysHost)) == NULL)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"System hostname misconfigured."</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Load system information into socket data structures</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_family = AF_INET;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Use any address available to the system. This is a typical configuration for a server.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Note that this is where the socket client and socket server differ.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// A socket client will specify the server address to connect to.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_addr.s_addr = htonl(INADDR_ANY); </code><code class="comments">// Translate long integer to network byte order.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_port = htons(portNumber);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// Set port number</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Bind the socket to a local socket address</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">( bind(socketHandle, (</code><code class="keyword bold">struct</code> <code class="plain">sockaddr *) &amp;socketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">perror</code><code class="plain">(</code><code class="string">"bind"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">listen(socketHandle, 1);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketConnection;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">( (socketConnection = accept(socketHandle, NULL, NULL)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// read/write to socket here</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
Socket functions:
<ul>
<li><b>bind()</b>:
<br>Function prototype:
<dl><dd>
<tt>int bind(int sockfd, struct sockaddr *my_addr, socklen_t addrlen);
</tt></dd></dl>
Bind arguments:
<ul>
<li>int sockfd: Socket file descriptor. Returned by call to "socket".
</li>
<li>struct sockaddr: Socket information structure
</li>
<li>socklen_t addrlen: Size of structure
</li>
<li>Returns 0: Sucess, -1: Failure and errno may be set.
</li>
</ul>
Also see the <a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=bind">bind man page</a>
<p>
</p>
</li>
<li><b>listen()</b>:
    <br> Function prototype:
<dl><dd>
<tt>int listen(int s, int backlog);
</tt></dd></dl>

Listen arguments:
<ul>
<li>int s: Socket file descriptor. Returned by call to "socket". Identifies a bound but unconnected socket.
</li>
<li>int backlog: Set maximum length of the queue of pending connections for the listening socket. A reasonable value is 10.
    Actual maximum permissible: <tt>SOMAXCONN</tt>
    <br>Example: <tt>int iret = listen(socketHandle, SOMAXCONN);</tt>
    <br>The include file <tt>sys/socket.h</tt> will include
          <tt>/usr/include/bits/socket.h</tt> which defines the default value for SOMAXCONN as 128. 
    <br>The actual value set for the operating system: <tt>cat /proc/sys/net/core/somaxconn</tt>
    <br>In kernels before 2.4.25, this limit was a hard coded value and thus would require a kernel recompile with the <tt>SOMAXCONN</tt> value as defined in <tt>/usr/include/linux/socket.h</tt>
    <br>For very heavy server use, modify the system limit in the proc file and set "backlog" to the same value (eg. 512).
</li>
<li>Returns 0: Sucess, -1: Failure and errno may be set.
</li>
</ul>
Also see the <a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=listen">listen man page</a>
<p>
</p>
</li>
<li><b>accept()</b>:
    <br> Function prototype:
<dl><dd>
<tt>int accept(int s, struct sockaddr *addr, socklen_t *addrlen);
</tt></dd></dl>

Accept arguments:
<ul>
<li>int s: Socket file descriptor. Returned by call to "socket".
</li>
<li>struct sockaddr *addr: Pointer to a sockaddr structure. This structure is filled in with the address of the connecting entity.
</li>
<li>socklen_t *addrlen: initially contains the  size  of  the
       structure  pointed  to  by  addr; on return it will contain the 
actual length (in bytes) of the address returned. When addr is  NULL  
nothing is filled in.
</li>
<li>Returns:
    <ul>
    <li>Success: non-negative integer, which is a descriptor of the accepted socket. Argument "addrlen" will have a return value.
    </li>
    <li>Fail: -1, errno may be set
    </li>
    </ul>
</li>
</ul>
Also see the <a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=accept">accept man page</a>
<p>
</p>
</li>
</ul>
<font color="#ff0000">[Potential Pitfall]:</font> If you get the following message:
<dl><dd>
<pre>bind: Address already in use
</pre>
</dd></dl>
The solution is to choose a different port or kill the process which is using the port and creating the conflict.
You may have to be root to see all processes with netstat.
<p>
<tt>netstat -punta | grep 8080</tt>
</p>
<dl><dd>
<tt> tcp        0      0 :::8080                     :::*                        LISTEN </tt>
</dd></dl>
  </dd>
</dl>
<p>
</p>
</li>
<li><b>Socket client:</b>
    <ul>
    <li><b>connect():</b> initiate a connection with a remote entity on a socket. Zero is returned on success. Support both TCP (<tt>SOCK_STREAM</tt>) and UDP (<tt>SOCK_DGRAM</tt>). For <tt>SOCK_STREAM</tt>, an actual connection is made. For <tt>SOCK_DGRAM</tt> the address is the address to which  datagrams are sent and received.
    </li>
    </ul>
<dl>
  <dd>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_412253"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_412253_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_412253" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">sockaddr_in remoteSocketInfo;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">hostent *hPtr;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">socketHandle;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="color1 bold">char</code> <code class="plain">*remoteHost=</code><code class="string">"dev.megacorp.com"</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">portNumber = 8080;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="plain">bzero(&amp;remoteSocketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(sockaddr_in));&nbsp; </code><code class="comments">// Clear structure memory</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="comments">// Get system information</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="keyword bold">if</code><code class="plain">((hPtr = gethostbyname(remoteHost)) == NULL)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"System DNS name resolution not configured properly."</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Error number: "</code> <code class="plain">&lt;&lt; ECONNREFUSED &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="comments">// Load system information for remote socket server into socket data structures</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="functions bold">memcpy</code><code class="plain">((</code><code class="color1 bold">char</code> <code class="plain">*)&amp;remoteSocketInfo.sin_addr, hPtr-&gt;h_addr, hPtr-&gt;h_length);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="plain">remoteSocketInfo.sin_family = AF_INET;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="plain">remoteSocketInfo.sin_port = htons((u_short)portNumber);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// Set port number</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="keyword bold">if</code><code class="plain">( (connect(socketHandle, (</code><code class="keyword bold">struct</code> <code class="plain">sockaddr *)&amp;remoteSocketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(sockaddr_in)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
Connect function prototype:
<dl><dd>
<tt>int  connect(int  sockfd,  const struct sockaddr *serv_addr, socklen_t addrlen);
</tt></dd></dl>
Connect arguments: (Same as server's <tt>bind()</tt> arguments)
<ul>
<li>int sockfd: Socket file descriptor. Returned by call to "socket".
</li>
<li>struct sockaddr: Socket information structure
</li>
<li>socklen_t addrlen: Size of structure
</li>
<li>Returns 0: Sucess, -1: Failure and errno may be set.
</li>
</ul>
Zero is returned upon success and on error, -1 and errno is set appropriately.
<br>
Also see the <a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=connect">connect man page</a>
  </dd>
</dl>
<hr>
<p>
<b>The sockaddr_in data structure:</b> <tt>/usr/include/linux/in.h</tt>
</p>
    <dl><dd>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_493952"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_493952_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_493952" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="comments">/* Internet address. */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">in_addr {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">__u32&nbsp;&nbsp; s_addr;&nbsp;&nbsp; </code><code class="comments">/* Defined as 32 or 64 bit address (system dependent) */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="comments">/* Structure describing an Internet (IP) socket address. */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="preprocessor">#define
 __SOCK_SIZE__&nbsp;&nbsp; 
16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 /* sizeof(struct sockaddr)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">sockaddr_in {</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">sa_family_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sin_family;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* Address family&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">short</code> <code class="color1 bold">int</code>&nbsp;&nbsp;&nbsp; <code class="plain">sin_port;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* Port number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">in_addr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sin_addr;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* Internet address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">/* Pad to size of `struct sockaddr'. */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">char</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="plain">__pad[__SOCK_SIZE__ - </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="color1 bold">short</code> <code class="color1 bold">int</code><code class="plain">) -</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">sizeof</code><code class="plain">(unsigned </code><code class="color1 bold">short</code> <code class="color1 bold">int</code><code class="plain">) - </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="keyword bold">struct</code> <code class="plain">in_addr)];</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
Note:
<ul>
<li><b>IP addresses:</b> Note the specific IP address could be specified:
<pre>     #include &lt;arpa/inet.h&gt;     // IP from string conversion

     socketInfo.sin_addr.s_addr = inet_addr("127.0.0.1");

     cout &lt;&lt; inet_ntoa(socketInfo.sin_addr) &lt;&lt; endl;
</pre>
or bind to all network interfaces available:
<pre>     socketInfo.sin_addr.s_addr = htonl(INADDR_ANY);
</pre>
<p>
</p>
</li>
<li><b>Port numbers:</b> Note the specific port can be specified:
<pre>     socketInfo.sin_port = htons(8080);

     cout &lt;&lt; ntohs(socketInfo.sin_port) &lt;&lt; endl;
</pre>
or let the system define one for you:
<pre>     socketInfo.sin_port = htons(INADDR_ANY);
</pre>
</li>
</ul>
    </dd></dl>
    <p>
    </p>
</li>
</ul>
</li>
<li><b>Read from or write to socket:</b>
<p>
Use send() and recv(), or write() and read(), or sendto() and recvfrom() to read/write to/from a socket.
</p>
<ul>
<li><b>TCP recv() or UDP recvfrom():</b> receive a message from a socket
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_238026"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_238026_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_238026" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="color1 bold">char</code> <code class="plain">*pcIpAddress;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="plain">unsigned </code><code class="color1 bold">short</code> <code class="plain">shPort;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(iSocketType == SOCK_STREAM)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">rc = recv(socketHandle, (</code><code class="color1 bold">char</code><code class="plain">*) _pcMessage, (</code><code class="color1 bold">int</code><code class="plain">) _iMessageLength, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">( rc == 0 )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"ERROR! Socket closed"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(rc == -1)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"ERROR! Socket error"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">closeSocket();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(iSocketType == SOCK_DGRAM)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">iLength;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in stReceiveAddr;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">iLength = (</code><code class="color1 bold">int</code><code class="plain">) </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">memset</code><code class="plain">((</code><code class="keyword bold">void</code><code class="plain">*) &amp;stReceiveAddr, 0, iLength);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">rc = recvfrom(socketHandle, (</code><code class="color1 bold">char</code><code class="plain">*) _pcMessage, (</code><code class="color1 bold">int</code><code class="plain">) _iMessageLength, 0,</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">(</code><code class="keyword bold">struct</code> <code class="plain">sockaddr *) &amp;stReceiveAddr, (socklen_t*) &amp;iLength))</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">{ rc == 0 )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"ERROR! Socket closed"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(rc == -1)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"ERROR! Socket error"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">closeSocket();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="plain">pcIpAddress = inet_ntoa(stReceiveAddr.sin_addr);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="plain">shPort = ntohs(stReceiveAddr.sin_port);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="plain">cout &lt;&lt; </code><code class="string">"Socket Received: "</code> <code class="plain">&lt;&lt; _iNumRead &lt;&lt; </code><code class="string">" bytes from "</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">&lt;&lt; pcIpAddress &lt;&lt; </code><code class="string">":"</code> <code class="plain">&lt;&lt; shPort &lt;&lt; endl; </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
<p>
</p>
</li>
<li><b>read():</b> read a specific number of bytes from a file descriptor
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_336217"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_336217_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_336217" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">rc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 0;&nbsp; </code><code class="comments">// Actual number of bytes read by function read()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">count&nbsp;&nbsp;&nbsp;&nbsp; = 0;&nbsp; </code><code class="comments">// Running total "count" of bytes read</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">numToRead = 32; </code><code class="comments">// Number of bytes we want to read each pass</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="color1 bold">char</code> <code class="plain">buf[512];</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="keyword bold">while</code><code class="plain">(bcount &lt; numToRead)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// rc is the number of bytes returned.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">( (rc = read(socketHandle, buf, numToRead - count)) &gt; 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">count += rc;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">buf += rc;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// Set buffer pointer for next read</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code><code class="plain">(rc &lt; 0)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">cout &lt;&lt; </code><code class="string">"Number of bytes read: "</code> <code class="plain">&lt;&lt; count &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">cout &lt;&lt; </code><code class="string">"Received: "</code> <code class="plain">&lt;&lt; buf &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
<p>
</p>
</li>
<li><b>send():</b> send a message from a socket. Used only when in a 
connected state. The  only  difference between  send  and  write  is  
the presence of flags.  With zero flags parameter, send is equivalent  
to  write.
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_822941"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_822941_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_822941" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;string.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">buf[512];</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">strcpy</code><code class="plain">(buf,</code><code class="string">"Message to send"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">send(socketHandle, buf, </code><code class="functions bold">strlen</code><code class="plain">(buf)+1, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
<p>
</p>
</li>
<li><b>TCP send() or UDP sendto():</b> 
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_413600"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_413600_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_413600" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">iSocketType;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">iBytesSent = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="color1 bold">char</code> <code class="plain">*pMessage = </code><code class="string">"message to send"</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="color1 bold">int</code>&nbsp; <code class="plain">iMessageLength = 16;&nbsp; </code><code class="comments">// number of bytes (includes NULL termination)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">sockaddr pSendAddress;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(iSocketType == SOCK_STREAM)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">((iBytesSent = send(socketHandle, (</code><code class="color1 bold">char</code><code class="plain">*) pMessage, (</code><code class="color1 bold">int</code><code class="plain">) iMessageLength, 0)) &lt; 0 )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Send failed with error "</code> <code class="plain">&lt;&lt; </code><code class="functions bold">errno</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">(iSocketType == SOCK_DGRAM)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">((iBytesSent = sendto(socketHandle, (</code><code class="color1 bold">char</code><code class="plain">*) pMessage, </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">) iMessageLength, </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">0,</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">(</code><code class="keyword bold">struct</code> <code class="plain">sockaddr*) pSendAddress,</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">) </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in))) &lt; 0 )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Sendto failed with error "</code> <code class="plain">&lt;&lt; </code><code class="functions bold">errno</code>&nbsp; <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="keyword bold">else</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Failed - Socket type not defined</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
<p>
</p>
</li>
</ul>
<p>
</p>
</li>
<li><b>Close the socket when done:</b>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_862194"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_862194_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_862194" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="preprocessor">#include &lt;unistd.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    This is the "C" library function to close a file descriptor.
    Returns zero on success, or -1 if an error occurred.
</li>
</ul>
<p>
</p>
<hr size="5">
<a name="SERVER"></a>
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Socket Server:</td>
    </tr>
  </tbody>
</table>
<p>
</p>
<h4>Simple Socket Server:</h4>
<dl>
  <dd>
File: <tt>server.cpp</tt>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_333975"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_333975_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_333975" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;iostream&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include &lt;sys/types.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#include &lt;sys/socket.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="preprocessor">#include &lt;netdb.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="preprocessor">#define MAXHOSTNAME 256</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="keyword bold">using</code> <code class="keyword bold">namespace</code> <code class="plain">std;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">main()</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in socketInfo;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">sysHost[MAXHOSTNAME+1];&nbsp; </code><code class="comments">// Hostname of this computer we are running on</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">hostent *hPtr;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketHandle;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">portNumber = 8080;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">bzero(&amp;socketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(sockaddr_in));&nbsp; </code><code class="comments">// Clear structure memory</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Get system information</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">gethostname(sysHost, MAXHOSTNAME);&nbsp; </code><code class="comments">// Get the name of this computer we are running on</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((hPtr = gethostbyname(sysHost)) == NULL)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"System hostname misconfigured."</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// create socket</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((socketHandle = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Load system information into socket data structures</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_family = AF_INET;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_addr.s_addr = htonl(INADDR_ANY); </code><code class="comments">// Use any address available to the system</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_port = htons(portNumber);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// Set port number</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Bind the socket to a local socket address</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">( bind(socketHandle, (</code><code class="keyword bold">struct</code> <code class="plain">sockaddr *) &amp;socketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(socketInfo)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">perror</code><code class="plain">(</code><code class="string">"bind"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">listen(socketHandle, 1);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketConnection;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">( (socketConnection = accept(socketHandle, NULL, NULL)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>58</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>59</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">rc = 0;&nbsp; </code><code class="comments">// Actual number of bytes read</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>60</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">buf[512];</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>61</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>62</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// rc is the number of characters returned.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>63</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Note this is not typical. Typically one would only specify the number </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>64</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// of bytes to read a fixed header which would include the number of bytes</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>65</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// to read. See "Tips and Best Practices" below.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>66</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>67</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">rc = recv(socketConnection, buf, 512, 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>68</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">buf[rc]= (</code><code class="color1 bold">char</code><code class="plain">) NULL;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// Null terminate string</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>69</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>70</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">cout &lt;&lt; </code><code class="string">"Number of bytes read: "</code> <code class="plain">&lt;&lt; rc &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>71</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">cout &lt;&lt; </code><code class="string">"Received: "</code> <code class="plain">&lt;&lt; buf &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>72</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
  </dd>
</dl>
<hr>
<p>
</p>
<h4>Forking Socket Server:</h4>
<p>
In order to accept connections while processing previous connections, use fork() to handle each connection.
</p>
<p>
</p>
<dl>
  <dd>
<p>
Use <tt>establish()</tt> and <tt>get_connection()</tt> to allow multiple connections.
</p>
File: <tt>serverFork.cpp</tt>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_612531"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_612531_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_612531" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;iostream&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include &lt;sys/types.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#include &lt;sys/socket.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="preprocessor">#include &lt;sys/wait.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="preprocessor">#include &lt;netdb.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="preprocessor">#include &lt;errno.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="preprocessor">#include &lt;unistd.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="preprocessor">#include &lt;signal.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="preprocessor">#include &lt;netinet/in.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="preprocessor">#define MAXHOSTNAME 256</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="keyword bold">using</code> <code class="keyword bold">namespace</code> <code class="plain">std;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="comments">// Catch signals from child processes</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">handleSig(</code><code class="color1 bold">int</code> <code class="plain">signum)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">while</code><code class="plain">(waitpid(-1, NULL, WNOHANG) &gt; 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="plain">main()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in socketInfo;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">sysHost[MAXHOSTNAME+1];&nbsp; </code><code class="comments">// Hostname of this computer we are running on</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">hostent *hPtr;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketHandle;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">portNumber = 8080;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">signal</code><code class="plain">(SIGCHLD, handleSig);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">bzero(&amp;socketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(sockaddr_in));&nbsp; </code><code class="comments">// Clear structure memory</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Get system information </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">gethostname(sysHost, MAXHOSTNAME);&nbsp; </code><code class="comments">// Get the name of this computer we are running on</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((hPtr = gethostbyname(sysHost)) == NULL)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"System hostname misconfigured."</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// create socket</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((socketHandle = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Load system information into socket data structures</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_family = AF_INET;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_addr.s_addr = htonl(INADDR_ANY); </code><code class="comments">// Use any address available to the system</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">socketInfo.sin_port = htons(portNumber);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// Set port number</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Bind the socket to a local socket address</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">( bind(socketHandle, (</code><code class="keyword bold">struct</code> <code class="plain">sockaddr *) &amp;socketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>58</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>59</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">perror</code><code class="plain">(</code><code class="string">"bind"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>60</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>61</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>62</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>63</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">listen(socketHandle, 1);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>64</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>65</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketConnection;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>66</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">for</code><code class="plain">(;;)&nbsp; </code><code class="comments">// infinite loop to handle remote connections. This should be limited.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>67</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>68</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">( (socketConnection = accept(socketHandle, NULL, NULL)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>69</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>70</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>71</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">(</code><code class="functions bold">errno</code> <code class="plain">== EINTR) </code><code class="keyword bold">continue</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>72</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">perror</code><code class="plain">(</code><code class="string">"accept"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>73</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>74</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>75</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">switch</code><code class="plain">(fork())</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>76</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>77</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">-1:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>78</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">perror</code><code class="plain">(</code><code class="string">"fork"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>79</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>80</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketConnection);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>81</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>82</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">case</code> <code class="plain">0:&nbsp;&nbsp; </code><code class="comments">// Child process - do stuff</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>83</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>84</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Do your server stuff like read/write messages to the socket here!</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>85</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>86</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">default</code><code class="plain">:&nbsp;&nbsp;&nbsp; </code><code class="comments">// Parent process, look for another connection</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>87</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketConnection);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>88</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">continue</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>89</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>90</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>91</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>92</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
  </dd>
</dl>
For more on the use of the <tt>fork()</tt> function see the YoLinux.com <a href="http://www.yolinux.com/TUTORIALS/ForkExecProcesses.html">fork() tutorial</a>.
<p>
</p>
<hr size="5">
<a name="CLIENT"></a>
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Socket Client:</td>
    </tr>
  </tbody>
</table>

<p>
</p>
<p>
<b>Simple Socket client:</b>
</p>
<dl>
  <dd>
File: <tt>client.cpp</tt>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_170933"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_170933_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_170933" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;iostream&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include &lt;string.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#include &lt;sys/types.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="preprocessor">#include &lt;sys/socket.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="preprocessor">#include &lt;netdb.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="preprocessor">#include &lt;unistd.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="preprocessor">#include &lt;errno.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="preprocessor">#define MAXHOSTNAME 256</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="keyword bold">using</code> <code class="keyword bold">namespace</code> <code class="plain">std;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="plain">main()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">sockaddr_in remoteSocketInfo;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">hostent *hPtr;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketHandle;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">*remoteHost=</code><code class="string">"localhost"</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">portNumber = 8080;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">bzero(&amp;remoteSocketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(sockaddr_in));&nbsp; </code><code class="comments">// Clear structure memory</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Get system information</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((hPtr = gethostbyname(remoteHost)) == NULL)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"System DNS name resolution not configured properly."</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Error number: "</code> <code class="plain">&lt;&lt; ECONNREFUSED &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// create socket</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((socketHandle = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Load system information into socket data structures</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">memcpy</code><code class="plain">((</code><code class="color1 bold">char</code> <code class="plain">*)&amp;remoteSocketInfo.sin_addr, hPtr-&gt;h_addr, hPtr-&gt;h_length);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">remoteSocketInfo.sin_family = AF_INET;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">remoteSocketInfo.sin_port = htons((u_short)portNumber);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// Set port number</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">(connect(socketHandle, (</code><code class="keyword bold">struct</code> <code class="plain">sockaddr *)&amp;remoteSocketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(sockaddr_in)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">exit</code><code class="plain">(EXIT_FAILURE);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">rc = 0;&nbsp; </code><code class="comments">// Actual number of bytes read by function read()</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">buf[512];</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">strcpy</code><code class="plain">(buf,</code><code class="string">"Message to send"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">send(socketHandle, buf, </code><code class="functions bold">strlen</code><code class="plain">(buf)+1, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
  </dd>
</dl>

<p>
</p>
<hr size="5">
<a name="TEST"></a>
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Test Simple Client and Server Socket program:</td>
    </tr>
  </tbody>
</table>

<p>
Note that this runs on a single system using "localhost".
</p>
Compile the simple client and the simple server:
<ul>
<li><tt>g++ server.cpp -o server</tt>
</li>
<li><tt>g++ client.cpp -o client</tt>
</li>
</ul>
Start the server: <tt>./server</tt>
<br>
This will block at the "accept()" call and await a connection from a client.
<p>
Start the client: <tt>./client</tt>
<br>
This will connect to the server and write the message "Message to send".
The server will receive the message and write it out.
</p>
<a name="DNS"></a>
<hr size="5">
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Name Resolution and Network Information Lookup:</td>
    </tr>
  </tbody>
</table>
<p>
</p>
Network information data lookup for:
<ul>
<li>DNS: Name resolution associates IP address to a hostname using DNS 
(Domain Name System) name servers. Name resolution invokes a series of 
library routines to query the name servers.
</li>
<li>TCP/IP ports and associated services
</li>
<li>Network Protocols
</li>
<li>Network name information
</li>
</ul>
<table border="1" cellpadding="2">
<tbody>
<tr bgcolor="#c0c0c0"><th>Function</th><th>Description</th></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=gethostname">gethostname</a>(char *name, size_t len)</td><td>returns hostname of local host</td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getservbyname">getservbyname</a>(const char *name,const char *proto)</td><td>returns a structure of type servent for the given host name and protocol</td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=gethostbyname">gethostbyname</a>(const char *name)</td><td>returns a structure of type hostent for the given host name</td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getservbyport">getservbyport</a>(int port, const char *proto)</td><td>
 returns a servent structure for the  line that  matches the port port 
given in network byte order using protocol proto. If proto is NULL, any 
protocol will be matched.</td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getservent">getservent</a>(void)</td><td>returns a structure servent containing the broken out fields from the line in <tt>/etc/services</tt></td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getprotobyname">getprotobyname</a>(const char *name)</td><td>returns  a  structure  protoent containing the broken out fields from the line in <tt>/etc/protocols</tt></td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getprotobynumber">getprotobynumber</a>(int proto)</td><td>returns a protoent structure  for  the line that matches the protocol number</td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getprotoent">getprotoent</a>(void)</td><td>returns  a  structure  protoent containing the broken out fields from the line in <tt>/etc/protocols</tt></td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getnetbyname">getnetbyname</a>(const char *name)</td><td>a structure netent containing the broken out fields from the line in <tt>/etc/networks</tt></td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getnetbyaddr">getnetbyaddr</a>(long net, int type)</td><td>returns a netent structure for the line that matches the network number net of type "type"</td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getaddrinfo">getaddrinfo</a>(const char *node, const char *service, const struct addrinfo *hints, struct addrinfo **res)<br>void freeaddrinfo(struct addrinfo *res)</td><td>Returns 0 if it succeeds or an error code. Network address and service translation<br>freeaddrinfo() frees the memory that was allocated by getaddrinfo()</td></tr>
<tr><td valign="top"><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getnetent">getnetent</a>(void)</td><td>returns a structure netent containing the broken out fields from the line  in <tt>/etc/networks</tt></td></tr>
</tbody>
</table>
<p>
</p>
Data Structures returned:
<dl>
  <dd>
<b>hostent</b> defined in &lt;netdb.h&gt;
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_663297"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_663297_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_663297" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">hostent {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code>&nbsp; <code class="plain">*h_name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* official name of host */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">**h_aliases;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* alias list */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code>&nbsp;&nbsp;&nbsp; <code class="plain">h_addrtype;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* host address type */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code>&nbsp;&nbsp;&nbsp; <code class="plain">h_length;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* length of address */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">**h_addr_list;&nbsp;&nbsp; </code><code class="comments">/* list of addresses */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    Lookup of data in <tt><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=hosts">/etc/hosts</a></tt> or from DNS resolution.
    <p>
    </p>
<b>servent</b> defined in &lt;netdb.h&gt;
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_855911"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_855911_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_855911" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">servent {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code>&nbsp;&nbsp;&nbsp; <code class="plain">*s_name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* official service name */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code>&nbsp;&nbsp;&nbsp; <code class="plain">**s_aliases;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* alias list */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code>&nbsp;&nbsp;&nbsp;&nbsp; <code class="plain">s_port;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* port number */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code>&nbsp;&nbsp;&nbsp; <code class="plain">*s_proto;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* protocol to use */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    Lookup of data in <tt><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=services">/etc/services</a></tt>
    <p>
    </p>
<b>protoent</b> defined in &lt;netdb.h&gt;
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_993888"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_993888_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_993888" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">protoent {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code>&nbsp;&nbsp;&nbsp; <code class="plain">*p_name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* official protocol name */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code>&nbsp;&nbsp;&nbsp; <code class="plain">**p_aliases;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* alias list */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code>&nbsp;&nbsp;&nbsp;&nbsp; <code class="plain">p_proto;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* protocol number */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    Lookup of data in <tt><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=protocols">/etc/protocols</a></tt>
    <p>
    </p>
<b>netent</b> defined in &lt;netdb.h&gt;
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_185887"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_185887_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_185887" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">netent {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code>&nbsp;&nbsp;&nbsp; <code class="plain">*n_name;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* official network name */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code>&nbsp;&nbsp;&nbsp; <code class="plain">**n_aliases;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* alias list */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code>&nbsp;&nbsp;&nbsp;&nbsp; <code class="plain">n_addrtype;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">/* net address type */</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">long</code> <code class="color1 bold">int</code> <code class="plain">n_net;&nbsp; </code><code class="comments">/* network number */</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    Lookup of data in <tt><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=networks">/etc/networks</a></tt>
  </dd>
</dl>
<p>
</p>
<a name="OPTIONS"></a>
<hr size="5">
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Socket Configuration Options:</td>
    </tr>
  </tbody>
</table>
<p>
</p>
<h4>Socket options:</h4>
<p>
One can "get" (read) the current socket options or "set" them to new values.
The default values are obtained from the OS:
</p>
<dl><dd>
<table border="1" cellpadding="2">
<tbody>
<tr bgcolor="#c0c0c0"><th>Level</th><th>Option</th><th>Type</th><th>Default</th><th>Description</th></tr>
<tr><td valign="top">IPPROTO_IP</td><td valign="top">TCP_NODELAY</td><td valign="top">int</td><td valign="top">0</td><td valign="top">Don't
 delay send to coalesce packets. If set, disable the Nagle algorithm. 
When not  set,  data  is  buffered  until there  is  a sufficient amount
 to send out, thereby avoiding the frequent sending of small packets, 
which results	in  poor  utilization of the network. Don't use with 
TCP_CORK. This option is overridden by TCP_CORK</td></tr>
<tr><td valign="top">IPPROTO_IP</td><td valign="top">TCP_MAXSEG</td><td valign="top">int</td><td valign="top">536</td><td valign="top">Maximum segment size for	outgoing TCP packets. TCP  will  impose  its minimum and maximum bounds over the value provided.</td></tr>
<tr><td valign="top">IPPROTO_IP</td><td valign="top">TCP_CORK</td><td valign="top">int</td><td valign="top">0</td><td valign="top">Control sending of partial frames. If set, don't send  out  partial	frames. Not cross platform.</td></tr>
<tr><td valign="top">IPPROTO_IP</td><td valign="top">TCP_KEEPIDLE</td><td valign="top">int</td><td valign="top">7200</td><td valign="top">When
 the SO_KEEPALIVE option is enabled, TCP probes a connection that has 
been idle for some amount of time. The default value for this idle 
period is 2 hours. The TCP_KEEPIDLE option can be used to affect this 
value for a given socket, and specifies the number of seconds of idle 
time between keepalive probes. <br>Not cross platform. This option takes an int value, with a range of 1 to 32767. </td></tr>
<tr><td valign="top">IPPROTO_IP</td><td valign="top">TCP_KEEPINTVL</td><td valign="top">int</td><td valign="top">75</td><td valign="top">Specifies the interval between packets that are sent to validate the connection.<br>Not cross platform. </td></tr>
<tr><td valign="top">IPPROTO_IP</td><td valign="top">TCP_KEEPCNT</td><td valign="top">int</td><td valign="top">9</td><td valign="top">When
 the SO_KEEPALIVE option is enabled, TCP probes a connection that has 
been idle for some amount of time. If the remote system does not respond
 to a keepalive probe, TCP retransmits the probe a certain number of 
times before a connection is considered to be broken. The TCP_KEEPCNT 
option can be used to affect this value for a given socket, and 
specifies the maximum number of keepalive probes to be sent. This option
 takes an int value, with a range of 1 to 32767. Not cross platform.</td></tr>
<tr><td valign="top">IPPROTO_IP</td><td valign="top">TCP_SYNCNT</td><td valign="top">int</td><td valign="top">5</td><td valign="top">Number of SYN retransmits that TCP should send before aborting the attempt to connect. It cannot  exceed  255.</td></tr>
<tr><td valign="top">IPPROTO_IP</td><td valign="top">TCP_LINGER2</td><td valign="top">int</td><td valign="top">60</td><td valign="top">Life time of orphaned FIN-WAIT-2 state. Not to be confused with option SO_LINGER<br>Not cross platform. </td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_REUSEADDR</td><td valign="top">int<br>(bool)</td><td valign="top">0</td><td valign="top">Allow
 local address reuse. If a problem is encountered when attempting to 
bind to a port which has been closed but not released (may take up to 2 
minutes as defined by TIME_WAIT). Apply the SO_REUSEADDR socket option 
to release the resource immediately and to get around the TIME_WAIT 
state.<br>0 = disables, 1 = enables</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_REUSEPORT</td><td valign="top">int<br>(bool)</td><td valign="top">0</td><td valign="top">This
 option is AF_INET socket-specific. This option allows multiple 
processes to share a port. All incoming multicast or broadcast UDP 
datagrams that are destined for the port are delivered to all sockets 
that are bound to the port. All processes that share the port must 
specify this option.<br>0 = disables, 1 = enables</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_ERROR</td><td valign="top">int<br>(bool)</td><td valign="top">0</td><td valign="top">When an error occurs on a socket, set error variable so_error and notify process<br>0 = disables, 1 = enables</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_BROADCAST</td><td valign="top">int<br>(bool)</td><td valign="top">0</td><td valign="top">Permit sending of broadcast datagrams<br>0 = disables, 1 = enables</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_SNDBUF</td><td valign="top">int<br>(value)</td><td valign="top">16384</td><td valign="top">Send buffer size</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_RCVBUF</td><td valign="top">int<br>(value)</td><td valign="top">87380</td><td valign="top">Receive buffer size</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_KEEPALIVE</td><td valign="top">int<br>(bool)</td><td valign="top">0</td><td valign="top">Periodically test if connection is alive<br>0 = disables, 1 = enables</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_SNDTIMEO</td><td valign="top">timeval<br>(struct)</td><td valign="top">0<br>0</td><td valign="top">Set timeout period for socket send.<br>Disable by setting timeval.tv_sec = 0 sec, timeval.tv_usec = 0 usec (default)<br>Affects write() writev() send() sendto() and sendmsg()</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_RCVTIMEO</td><td valign="top">timeval<br>(struct)</td><td valign="top">0<br>0</td><td valign="top">Set timeout period for socket receive.<br>Disable by setting timeval.tv_sec = 0 sec, timeval.tv_usec = 0 usec (default)<br>Affects read() readv() recv() recvfrom() and recvmsg()</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_LINGER</td><td valign="top">linger<br>(struct)</td><td valign="top">0<br>0</td><td valign="top">Specifies how close function will operate for connection protocols (TCP)<br>l_onoff: 0 = disables, 1 = enables<br>l_linger:
 0 = unsent data discarded, 1 = close() does not return untill all 
unsent data is transmitted or remote connection is closed<br>Structure defined in <tt>sys/socket.h</tt></td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_RCVLOWAT</td><td valign="top">int<br>(value)</td><td valign="top">1</td><td valign="top">Specifies number of bytes used as a threshold by <tt>select()</tt> to consider a socket read ready</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_SNDLOWAT</td><td valign="top">int<br>(value)</td><td valign="top">1</td><td valign="top">Specifies number of bytes used as a threshold by <tt>select()</tt> to consider a socket write ready</td></tr>
<tr><td valign="top">SOL_SOCKET</td><td valign="top">SO_TYPE</td><td valign="top">int<br>(value)</td><td valign="top">undefined</td><td valign="top">Specifies socket type (e.g., tcp (SOCK_STREAM), udp (SOCK_DGRAM), etc.) <br>For use with <tt>getsockopt()</tt> only.</td></tr>
</tbody>
</table>
IPPROTO_IP macro defines are found in <tt>/usr/include/netinet/tcp.h</tt>
<br>
SOL_SOCKET macro defines require <tt>/usr/include/sys/socket.h</tt>
<p>
For a full list of options see the <a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=tcp">TCP man page</a>
</p>
<p>
For a full list of IP options see the <a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=ip%287%29">IP(7) man page</a>
</p>
</dd></dl>
<p>
</p>
Function Prototypes:
<dl><dd>
<tt>
int  getsockopt(int s, int level, int optname, void *optval, socklen_t *optlen);
<br>
int setsockopt(int s, int level,  int  optname,  const  void  *optval, socklen_t optlen);
</tt>
<p>
</p>
getsockopt/setsockopt arguments:
<ul>
<li>int sockfd: Socket file descriptor. Returned by call to "socket".
</li>
<li>int level: See table above
</li>
<li>int optname: See table above
</li>
<li>void *optval: Pointer to value or data structure
</li>
<li>optlen: Length of "optval"
</li>
<li>Returns 0: Sucess, -1: Failure and errno may be set.
</li>
</ul>
</dd></dl>
<p>
Code to read socket options:
</p>
<dl><dd>
    File: <tt>printSocketOptions.c</tt>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_616682"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_616682_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_616682" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;sys/socket.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include &lt;netinet/in.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#include &lt;netinet/tcp.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="preprocessor">#include &lt;errno.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="preprocessor">#include &lt;stdio.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">main()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketHandle;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// create socket</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">((socketHandle = socket(AF_INET, SOCK_STREAM, IPPROTO_IP)) &lt; 0)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">perror</code><code class="plain">(</code><code class="string">"socket"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">iSocketOption = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">iSocketOptionLen = </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">);;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">linger SocketOptionLinger;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">iSocketOptionLingerLen = </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="keyword bold">struct</code> <code class="plain">linger);;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, IPPROTO_TCP, TCP_NODELAY, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket TCP_NODELAY = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, IPPROTO_TCP, TCP_MAXSEG, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket TCP_MAXSEG = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, IPPROTO_TCP, TCP_CORK, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket TCP_CORK = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, IPPROTO_TCP, TCP_KEEPIDLE, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket TCP_KEEPIDLE = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, IPPROTO_TCP, TCP_KEEPINTVL, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket TCP_KEEPINTVL = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, IPPROTO_TCP, TCP_KEEPCNT, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket TCP_KEEPCNT = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, IPPROTO_TCP, TCP_SYNCNT, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket TCP_SYNCNT = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, IPPROTO_TCP, TCP_LINGER2, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket TCP_LINGER2 = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, SOL_SOCKET, SO_REUSEADDR, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket SO_REUSEADDR = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, SOL_SOCKET, SO_ERROR, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket SO_ERROR = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, SOL_SOCKET, SO_BROADCAST, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket SO_BROADCAST = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>58</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, SOL_SOCKET, SO_KEEPALIVE, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>59</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket SO_KEEPALIVE = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>60</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>61</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, SOL_SOCKET, SO_SNDBUF, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>62</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket SO_SNDBUF = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>63</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>64</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, SOL_SOCKET, SO_RCVBUF, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>65</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket SO_RCVBUF = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>66</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>67</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, SOL_SOCKET, SO_LINGER, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;SocketOptionLinger, &amp;iSocketOptionLingerLen);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>68</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket SO_LINGER = %d&nbsp; time = %d\n"</code><code class="plain">, SocketOptionLinger.l_onoff, SocketOptionLinger.l_linger);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>69</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>70</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">getsockopt(socketHandle, SOL_SOCKET, SO_RCVLOWAT, (</code><code class="color1 bold">char</code> <code class="plain">*)&amp;iSocketOption, &amp;iSocketOptionLen);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>71</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">printf</code><code class="plain">(</code><code class="string">"Socket SO_RCVLOWAT = %d\n"</code><code class="plain">, iSocketOption);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>72</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    Compile: <tt>gcc -o printSocketOptions printSocketOptions.c</tt>
<p>
<a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getsockopt&amp;cgi_section=2">getsockopt man page</a>: get a particular socket option for the specified socket.
</p>
</dd></dl>
<p>
</p>
<h4>Set socket options:</h4>
<ul>
<li>Socket "keep-alive":
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_979954"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_979954_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_979954" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">iOption = 1; </code><code class="comments">// Turn on keep-alive, 0 = disables, 1 = enables</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(setsockopt(socketHandle, SOL_SOCKET, SO_KEEPALIVE, (</code><code class="keyword bold">const</code> <code class="color1 bold">char</code> <code class="plain">*) &amp;iOption,&nbsp; </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">)) == SOCKET_ERROR)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Set keepalive: Keepalive option failed"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
<p>
</p>
</li>
</ul>
<p>
</p>
<h4>Set socket client options:</h4>
<ul>
<li>Socket re-use:
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_566907"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_566907_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_566907" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">iOption = 0;&nbsp; </code><code class="comments">// Reuse address option to set, 0 = disables, 1 = enables</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(setsockopt(socketHandle, SOL_SOCKET, SO_REUSEADDR, (</code><code class="keyword bold">const</code> <code class="color1 bold">char</code> <code class="plain">*) &amp;iOption,&nbsp; </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">)) == SOCKET_ERROR)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Set reuse address: Client set reuse address option failed"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    When a socket connection is closed with a call to <tt>close(), shutdown()</tt> or <tt>exit()</tt>,
 both the client and server will send a FIN (final) packet and will then
 send an acknowledgment (ACK) that they received the packet.
    The side which initiates the closure will be in a <tt>TIME_WAIT</tt>
 state until the process has been completed. 
    This time out period is generally 2-4 minutes in duration. It is 
hoped that all packets are received in a timely manner and the entire 
time out duration is not required. When an application is abnormally 
terminated, the <tt>TIME_WAIT</tt> period is entered for the full duration.
    <p>
    Setting the <tt>SO_REUSEADDR</tt> option explicitly allows a process to bind a port in the <tt>TIME_WAIT</tt> state. This is to avoid the error "<tt>bind: Address Already in Use</tt>". One caviat is that the process can not be to the same address and port as the previous connection. If it is, the <tt>SO_REUSEADDR</tt> option will not help and the duration of the <tt>TIME_WAIT</tt> will be in effect.
    <br>For more info see <a href="http://hea-www.harvard.edu/%7Efine/Tech/addrinuse.html">How to avoid the "Address Already in Use" error</a>.
    </p>
    <p>
    </p>
    Solution: Enable socket linger:
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_149157"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_149157_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_149157" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">linger Option;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">Option.l_onoff = 1;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Option.l_linger = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="keyword bold">if</code><code class="plain">(setsockopt(socketHandle, SOL_SOCKET, SO_LINGER, (</code><code class="keyword bold">const</code>&nbsp; <code class="color1 bold">char</code> <code class="plain">*) &amp;Option,&nbsp; </code><code class="keyword bold">sizeof</code><code class="plain">(linger)) == -1)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Set SO_LINGER option failed"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    This allows the socket to die quickly and allow the address to be 
reused again. 
    Warning: This linger configuration specified may/will result in data
 loss upon socket termination, thus it would not have the robustness 
required for a banking transaction but would be ok for a recreational 
app.
    <p>
    </p>
</li>
<li>Broadcast:
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_836850"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_836850_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_836850" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">iOption = 0;&nbsp; </code><code class="comments">// Broadcast option to set, 0 = disables, 1 = enables</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="keyword bold">if</code> <code class="plain">(setsockopt(socketHandle, SOL_SOCKET, SO_BROADCAST, (</code><code class="keyword bold">const</code> <code class="color1 bold">char</code> <code class="plain">*) &amp;iOption,&nbsp; </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">)) == SOCKET_ERROR)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Set reuse address: Client set reuse address option failed"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    Struct: <tt>remoteSocketInfo.sin_addr.s_addr = htonl(INADDR_BROADCAST);</tt>
</li>
</ul>
<p>
<a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=setsockopt&amp;cgi_section=2">setsockopt man page</a>: set a particular socket option for the specified socket.
</p>
<a name="AVAILABILITY"></a>
<hr size="5">
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Test Socket Availability:</td>
    </tr>
  </tbody>
</table>

<p>
</p>
<p>
</p>
Function to test if a socket or set of sockets has data and can be read (Test so you don't get blocked on a read) or written.
<dl>
  <dd>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_308916"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_308916_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_308916" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;sys/select.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include &lt;sys/time.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="color1 bold">bool</code> <code class="plain">isReadyToRead(</code><code class="color1 bold">int</code> <code class="plain">_socketHandle, </code><code class="keyword bold">const</code> <code class="color1 bold">long</code> <code class="plain">&amp;_lWaitTimeMicroseconds)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">iSelectReturn = 0;&nbsp; </code><code class="comments">// Number of sockets meeting the criteria given to select()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">timeval timeToWait;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">fd_max = -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// Max socket descriptor to limit search plus one.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">fd_set readSetOfSockets;&nbsp; </code><code class="comments">// Bitset representing the socket we want to read</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// 32-bit mask representing 0-31 descriptors where each </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// bit reflects the socket descriptor based on its bit position.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">timeToWait.tv_sec&nbsp; = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">timeToWait.tv_usec = _lWaitTimeMicroseconds;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">FD_ZERO(&amp;readSetOfSockets);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">FD_SET(_socketHandle, &amp;readSetOfSockets);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">(_socketHandle &gt; fd_max)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">fd_max = _socketHandle;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">iSelectReturn = select(fd_max + 1, &amp;readSetOfSockets, (fd_set*) 0, (fd_set*) 0, &amp;timeToWait);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// iSelectReturn -1: ERROR, 0: no data, &gt;0: Number of descriptors found which pass test given to select()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">( iSelectReturn == 0 )&nbsp; </code><code class="comments">// Not ready to read. No valid descriptors</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="keyword bold">false</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">( iSelectReturn &lt; 0 )&nbsp; </code><code class="comments">// Handle error</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"*** Failed with error "</code>&nbsp;&nbsp; <code class="plain">&lt;&lt; </code><code class="functions bold">errno</code> <code class="plain">&lt;&lt; </code><code class="string">" ***"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(_socketHandle);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="keyword bold">false</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Got here because iSelectReturn &gt; 0 thus data available on at least one descriptor</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Is our socket in the return list of readable sockets</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">( FD_ISSET(_socketHandle, &amp;readSetOfSockets) )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="keyword bold">true</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="keyword bold">false</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="keyword bold">false</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    Arguments to <tt>select()</tt>:
    <ol>
    <li><b>int fd_max:</b> Highest socket descriptor number. When opening a socket with the call <tt>socket()</tt>, the function returns a socket descriptor number.
        The call to <tt>select()</tt> will loop through all of the socket descriptors from zero up to fd_max to perform the "test".
    </li>
    <li><b>fd_set *readSetOfSockets:</b> This is a pointer to the 
variable holding the set of bits representing the set of sockets to test
 for readability. (Read will not block)
        <br>The default number of bytes detected for the socket to be 
considered ready to read is 1. To change this default use (in this 
example 8 bytes):
        <dl><dd>
        <tt>int nBytes = 8;
        <br>setsockopt(socketHandle, SOL_SOCKET, SO_RCVLOWAT,(const char *) &amp;nBytes,  sizeof(int))</tt>
        </dd></dl>
    </li>
    <li><b>fd_set *writeSetOfSockets:</b> This is a pointer to the 
variable holding the set of bits representing the set of sockets to test
 for writeability. (Write will not block)
    </li>
    <li><b>fd_set *exceptfds:</b> This is a pointer to the variable holding the set of bits representing the set of sockets to test for exceptions.
    </li>
    <li><b>struct timeval *timeout:</b> This structure holds the upper 
bound on the amount of time elapsed before select returns. It may be 
zero, causing select to return  immediately. If timeout is NULL (no 
timeout), select can block indefinitely.
        <pre>    struct timeval {
        long    tv_sec;         /* seconds */
        long    tv_usec;        /* microseconds */
    };
        </pre>
    </li>
    </ol>
    Note: Any of the tests (read/write/exceptions) can be set to NULL to ignore that test.
    <p>
    Also see the <a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=select">select man page</a>
    </p>
  </dd>
</dl>
<p>
</p>
<p>
</p>
<hr size="5">
<a name="PORTS"></a>
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Port Numbers:</td>
    </tr>
  </tbody>
</table>

<p>
The use of port numbers below 1024 are limited to the root process.
For a list of port numbers with established uses see the file <tt>/etc/services</tt>.
</p>
<p>
Posts are 16 bit identifiers. Many are reserved and managed by the Internet Assigned Numbers Authority (IANA).
<br>
See <a href="http://www.ietf.org/rfc/rfc1700.txt">RFC 1700</a>.
</p>
<hr size="5">
<a name="ENDIAN"></a>
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Host and Network Byte Order:</td>
    </tr>
  </tbody>
</table>

<p>
Note that when transferring data between different platforms or with Java, the byte order endianess will have to be considered.
The network (the neutral medium) byte order is Big Endian and the byte order to which data is usually marshalled.
</p>
<p>
<b>Host processor byte order:</b>
</p><dl><dd>
<table border="1">
<tbody>
<tr bgcolor="#c0c0c0"><th>Host Processor</th><th>Endianness</th></tr>
<tr><td>Intel x86 processor family</td><td> Little endian</td></tr>
<tr><td>Power PC processor family</td><td> Big endian</td></tr>
<tr><td>SUN SPARC</td><td> Big endian</td></tr>
<tr><td>Mips</td><td> Big endian (IRIX)</td></tr>
<tr><td>Mips</td><td> Little endian (NT)</td></tr>
</tbody>
</table>
</dd></dl>
Note that it is the processor architecture which determines the endianness and NOT the OS.
The exception is for processors which support both big and little endian byte ordering, such as the MIPS processor.
<p></p>
<p>
Also note: Java processes and stores data in big endian byte ordering on any platform.
</p>
<p>
Character data is not subject to this problem as each character is one byte in length but integer is.
</p>
<p>
Integer data can be converted from/to host or network byte order with the following routines: 
</p>
<dl><dd>
<table border="1" cellpadding="1">
<tbody>
<tr bgcolor="#c0c0c0"><th>Function</th><th>Description</th></tr>
<tr><td>ntohl()</td><td>Network to host byte order conversion for long integer data (uint32_t)</td></tr>
<tr><td>ntohs()</td><td>Network to host byte order conversion for short integer data (uint16_t)</td></tr>
<tr><td>htonl()</td><td>Host to network byte order conversion for long integer data (uint32_t)</td></tr>
<tr><td>htons()</td><td>Host to network byte order conversion for short integer data (uint16_t)</td></tr>
</tbody>
</table>
Requires <tt>#include &lt;arpa/inet.h&gt;</tt>
<br>
The routines are aware of the processor they are running on and thus 
either perform a conversion or not, depending if it is required.
</dd></dl>
<p>
</p>
Man pages:
<ul>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=ntohl&amp;cgi_section=3">ntohl/htonl, ntohs/htons</a>: convert values between host and network byte order
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=htons&amp;cgi_section=3">htobe16()/be16toh(), also 32 and 64 bit</a>: convert values  between  host  and big-/little-endian byte order
</li>
</ul>

Note that one uses these calls for portable code on any platform.
The port of the library to that platform determines whether a byte swap will occur and not your source code.
<p>
</p><hr>
<p></p>
Include file/code snipit to determine the processor endianess:
<dl><dd>
File: <tt>is_bigendian.h</tt>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_898336"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_898336_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_898336" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="preprocessor">#ifndef __IS_BIGENDIAN__</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="preprocessor">#define __IS_BIGENDIAN__</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="keyword bold">const</code> <code class="color1 bold">int</code> <code class="plain">bsti = 1;&nbsp; </code><code class="comments">// Byte swap test integer</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="preprocessor">#define is_bigendian() ( (*(char*)&amp;bsti) == 0 )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="preprocessor">#endif // __IS_BIGENDIAN__</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
</dd></dl>

<p>
</p><hr>
<p></p>
Code snipit to swap bytes "in place" and convert endian:
<dl><dd>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_438118"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_438118_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_438118" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;netdb.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include "is_bigendian.h"</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="comments">/**</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">In-place swapping of bytes to match endianness of hardware</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">@param[in/out] *object : memory to swap in-place</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">@param[in]&nbsp;&nbsp;&nbsp;&nbsp; _size&nbsp;&nbsp; : length in bytes</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="comments">*/</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">swapbytes(</code><code class="keyword bold">void</code> <code class="plain">*_object, </code><code class="color1 bold">size_t</code> <code class="plain">_size)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">char</code> <code class="plain">*start, *end;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">(!is_bigendian())</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">for</code> <code class="plain">( start = (unsigned </code><code class="color1 bold">char</code> <code class="plain">*)_object, end = start + _size - 1; start &lt; end; ++start, --end )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">char</code> <code class="plain">swap = *start;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">*start = *end;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">*end = swap;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
</dd></dl>

<p>
</p><hr>
<p></p>
Swaping bit field structures:
<dl><dd>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_691886"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_691886_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_691886" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;netdb.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include "is_bigendian.h"</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">swapbytes(</code><code class="keyword bold">void</code> <code class="plain">*_object, </code><code class="color1 bold">size_t</code> <code class="plain">_size);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="comments">// Struct size of four bytes</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">ExampleA</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="preprocessor">#ifdef BIGENDIAN</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">a:1;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">b:1;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">c:1;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">d:1;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">e:4;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">f:8;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">g:8;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">h:8;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="preprocessor">#else</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">h:8;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">g:8;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">f:8;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">e:4;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">d:1;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">c:1;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">b:1;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">int</code> <code class="plain">a:1;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content"><code class="preprocessor">#endif</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Bits:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//&nbsp;&nbsp; |B31....B25 |B24....B16 |B15....B8&nbsp; |B7....B0&nbsp;&nbsp; | Big endian</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//&nbsp;&nbsp; |B7....B0&nbsp;&nbsp; |B15....B8&nbsp; |B24....B16 |B31....B25 | Little endian</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Intel host to network:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//&nbsp;&nbsp; Reverse bit field structure and then byte swap.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//&nbsp;&nbsp; Just byteswap for int.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Code body </code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">struct</code> <code class="plain">ExampleA exampleA;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">char</code> <code class="plain">tmpStore[4];</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// assign member variables:</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">exampleA.a = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">exampleA.b = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">exampleA.c = 1;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">exampleA.d = 1;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">exampleA.e = 3;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Use memcpy() because we can't cast a bitfield</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>58</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">memcpy</code><code class="plain">(&amp;tmpStore, &amp;exampleA, </code><code class="keyword bold">sizeof</code><code class="plain">(ExampleA));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>59</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>60</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">swapbytes((</code><code class="keyword bold">void</code> <code class="plain">*)&amp;tmpStore, </code><code class="keyword bold">sizeof</code><code class="plain">(ExampleA));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>61</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>62</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
</dd></dl>
<p>
For complete coverage on big and little endian byte order and byte order conversion see the YoLinux <a href="http://www.yolinux.com/TUTORIALS/Endian-Byte-Order.html">Endian Byte Order tutorial</a>.
</p>


<hr size="5">
<a name="TIPS"></a>
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Socket Tips and Best Practices:</td>
    </tr>
  </tbody>
</table>
<p>
</p>
<ul>
<li><b>Re-connect:</b> If a socket client attempts to connect to a 
socket server and fails, one should attempt to re-attach after a given 
waiting period, a fixed number of times.
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_115153"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_115153_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_115153" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">iTry = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">mRetrymax = 10;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">mRetrywait = 2;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="comments">// If this client can not connect to the server, try again after period "Retrywait".</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="keyword bold">while</code> <code class="plain">( connect(socketHandle, (</code><code class="keyword bold">struct</code> <code class="plain">sockaddr *)&amp;remoteSocketInfo, </code><code class="keyword bold">sizeof</code><code class="plain">(sockaddr_in)) &lt; 0 )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">iTry++;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code><code class="plain">( iTry &gt; mRetrymax )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Failed to connect to server. Exceeded maximum allowable attempts: "</code> <code class="plain">&lt;&lt; mRetrymax &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;&nbsp; </code><code class="comments">// Done retrying!</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">sleep( mRetrywait );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
<p>
</p>
</li>
<li><b>Check return codes:</b> Just because the socket was opened 
doesn't mean it will stay open. Dropped connections do happen. Check all
 read/write socket API function return codes:
    <ul>
    <li>return code &gt; 0: Data received/sent
    </li>
    <li>return code == 0: Socket closed
    </li>
    <li>return code == -1: Check system errno and interpret (or call "<a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=perror&amp;cgi_section=3">perror()</a>")
    </li>
    </ul>
    <p>
    For even more robust code for a socket client, close, then open a new socket connection for return codes 0 or -1.
    </p>
<p>
</p>
</li>
<li><b>Read entire message:</b> (Variable and fixed length messages) 
When sending messages using a socket, be aware that the other side of 
connection must know how much to read. This means that you must:
    <ul>
    <li>Send fixed message sizes of a known number of bytes where all messages sent are of the same size
        <br>
        or
    </li>
    <li>Send a message with a header of a known size where the message 
size is sent in the header. Thus read the fixed size header and 
determine the size of the whole message then read the remaining bytes.
    </li>
    </ul>
<p>
    Note that with a UDP client/server communications, the socket read 
will read the whole frame sent. 
    This is not necessarily true for a TCP stream. The function used to 
read the stream will return the number of bytes read. 
    If the required number of bytes have not been read, repeat the read 
for the remaining bytes until the whole message has been read.
</p>
   In this example, our message header is a single integer used to store 
   the message size in the first 32 bits of the message.
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_751756"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_751756_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_751756" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;iostream&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include &lt;arpa/inet.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#include &lt;sys/socket.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="preprocessor">#include &lt;sys/types.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="preprocessor">#include &lt;stdio.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="preprocessor">#include &lt;error.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="keyword bold">using</code> <code class="keyword bold">namespace</code> <code class="plain">std;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Data: Message Header and Size</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">rc = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">messageSize = 0;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">remainingMessageSize = 0;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">messageHeaderSize = </code><code class="keyword bold">sizeof</code><code class="plain">(</code><code class="color1 bold">int</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">char</code> <code class="plain">*headerBuf= </code><code class="keyword bold">new</code> <code class="plain">unsigned </code><code class="color1 bold">char</code><code class="plain">[messageHeaderSize ];</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Read Message Header</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketConnection;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Prototype: ssize_t recv(int s, void *buf, size_t len, int flags);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// rc is the number of bytes returned.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">rc = recv(socketConnection, headerBuf, messageHeaderSize , 0);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">( rc == 0 )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Socket closed"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">( rc == -1 )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Socket error"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">( rc != messageHeaderSize ) </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Problem reading header"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Read message</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">messageTotalSize;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">tmp = htonl((uint32_t)headerBuf);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">memcpy</code><code class="plain">((</code><code class="keyword bold">void</code> <code class="plain">*)&amp;messageSize,(</code><code class="keyword bold">void</code> <code class="plain">*)&amp;tmp, messageHeaderSize );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Create storage buffer for the message</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">unsigned </code><code class="color1 bold">char</code> <code class="plain">*messageTotalBuf = </code><code class="keyword bold">new</code> <code class="plain">unsigned </code><code class="color1 bold">char</code><code class="plain">[messageTotalSize ];</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Copy header into message buffer</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="functions bold">memcpy</code><code class="plain">(messageTotalBuf, &amp;headerBuf, messageHeaderSize );</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// How much more to read</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">remainingMessageSize = messageTotalSize - messageHeaderSize;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Character buffer pointer math: Put rest of message after header.</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">messageTotalBuf += messageHeaderSize;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">while</code><code class="plain">(1)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>58</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">rc = recv(socketConnection, messageTotalBuf, remainingMessageSize, 0);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>59</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>60</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">( rc == 0 )</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>61</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>62</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Socket closed"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>63</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>64</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>65</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code> <code class="plain">( rc == -1 )</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>66</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>67</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Socket error"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>68</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">perror</code><code class="plain">(</code><code class="string">"recv"</code><code class="plain">);</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>69</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketConnection);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>70</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>71</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>72</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">if</code><code class="plain">( rc != remainingMessageSize)</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>73</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>74</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Still more to read but less by what we have just read.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>75</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">remainingMessageSize = remainingMessageSize - rc;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>76</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>77</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Character buffer pointer math: Put rest of message after header</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>78</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//&nbsp; and what has already been put there by recv().</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>79</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">messageTotalBuf += rc;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>80</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>81</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">else</code> <code class="keyword bold">break</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>82</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>83</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>84</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="comments">// Now have message in messageTotalBuf of size messageTotalSize</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>85</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>86</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>87</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
This example applies to either client or server TCP sockets.
<p>
</p>
Another method of ensuring a complete read of a fixed size message is to use the <tt>MSG_WAITALL</tt> flag:
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_195995"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_195995_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_195995" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">flags = MSG_WAITALL;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">rc = recv(socketConnection, buffer, length, flags); </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="plain">...</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
On "SOCK_STREAM" (TCP) sockets, this flag requests that the recv() function block until the full amount of data specified (<tt>length</tt>)
 can be returned.
The function may return the smaller amount of data if the socket is a 
message-based socket, if a signal is caught or if the connection is 
terminated. 
<p>
</p>
</li>
<li><b>UDP message order:</b> TCP will guarentee that the order of the 
message delivery is maintained. 
    UDP will not guarentee the message delivery order and thus you will 
have to maintain a counter in the message if the order is important.
<p>
</p>
</li>
<li><b>Signals:</b> The socket layer can issue signals, which if not handled, can terminate your application. 
    When a socket is terminated at one end, the other may receive a <tt>SIGPIPE</tt> signal.
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <pre>Program received signal SIGPIPE, Broken pipe.
0x000000395d00de45 in send () from /lib64/libpthread.so.0
(gdb) where
#0  0x000000395d00de45 in send () from /lib64/libpthread.so.0
#1  0x00000000004969c5 in bla bla bla
...
...
          </pre>
          </td>
        </tr>
      </tbody>
    </table>
    Note GDB will report a received signal even if it's being ignored by the application.
    <br>In this example, we tried to <tt>send()</tt> over a broken socket link.
    <p>
    </p>
    Set up a signal handler at the beginning of your program to handle <tt>SIGPIPE</tt>:
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_491769"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_491769_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_491769" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#include &lt;stdlib.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include &lt;signal.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="comments">/// Ignore signal with this handler</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="keyword bold">void</code> <code class="plain">handleSigpipe(</code><code class="color1 bold">int</code> <code class="plain">signum)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain">cout &lt;&lt; </code><code class="string">"SIGPIPE ignored"</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">return</code><code class="plain">;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">main()</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">/// Ignore SIGPIPE "Broken pipe" signals when socket connections are broken.</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="functions bold">signal</code><code class="plain">(SIGPIPE, handleSigpipe);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
    </p>
    Also see:
    <ul>
    <li><a href="http://www.yolinux.com/TUTORIALS/C++Signals.html">C++ Signal class tutorial</a> - YoLinux.com tutorial
    </li>
    <li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=signal">signal</a>: Signal handling
    </li>
    <li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=sigaction">sigaction</a>: examine and change a signal action
    </li>
    </ul>
<p>
</p>
</li>
</ul>

<a name="WIN32"></a>
<p>
</p>
<hr size="5">
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Win32 and cross platform considerations:</td>
    </tr>
  </tbody>
</table>
<p>
The beauty of the BSD API is that it is nativly supported by Microsoft 
Visual C++ but there are some slight differences which can be wrapped in
 an "ifdef".
</p>
<dl><dd>
    <table class="code" border="0" cellpadding="4" cellspacing="1">
      <tbody>
        <tr class="code">
          <td>
          <div class="syntaxhighlighter  " id="highlighter_865798"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_865798_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_865798" menu="false" src="Sockets_files/clipboard.swf" width="16" height="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="preprocessor">#ifdef WIN32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Windows</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="preprocessor">#include "StdAfx.h"</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="preprocessor">#include &lt;windows.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="preprocessor">#include &lt;winsock2.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="preprocessor">#include &lt;winsock.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="preprocessor">#else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 // Unix/Linux</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="preprocessor">#include &lt;errno.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="preprocessor">#include &lt;sys/types.h&gt;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="preprocessor">#include &lt;sys/socket.h&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="preprocessor">#endif</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>13</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>14</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>15</code></td><td class="content"><code class="preprocessor">#ifdef WIN32</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>16</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">SOCKET socketHandle;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>17</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">WSADATA oWSAData;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>18</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="functions bold">memset</code><code class="plain">(&amp;oWSAData, 0, </code><code class="keyword bold">sizeof</code><code class="plain">(oWSAData));</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>19</code></td><td class="content"><code class="preprocessor">#else</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>20</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">socketHandle;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>21</code></td><td class="content"><code class="preprocessor">#endif</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>22</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>23</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>24</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>25</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>26</code></td><td class="content"><code class="preprocessor">#ifdef WIN32</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>27</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="color1 bold">int</code> <code class="plain">iWSAError;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>28</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>29</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Load the WSA structure</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>30</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>31</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">((iWSAError = WSAStartup(MAKEWORD(2, 2), &amp;oWSAData)) != 0)</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>32</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>33</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Creating the WSAStartup failed with error "</code> <code class="plain">&lt;&lt; iWSAError &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>34</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>35</code></td><td class="content"><code class="preprocessor">#endif</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>36</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>37</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>38</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>39</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">//&nbsp; Make sockets calls here</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>40</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>41</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>42</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>43</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="comments">// Manage errors here</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>44</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>45</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">cerr &lt;&lt; </code><code class="string">"Failed with error "</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>46</code></td><td class="content"><code class="preprocessor">#ifdef WIN32</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>47</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">&lt;&lt; WSAGetLastError() &lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>48</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">WSACleanup();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>49</code></td><td class="content"><code class="preprocessor">#else</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>50</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">&lt;&lt; </code><code class="functions bold">errno</code> <code class="plain">&lt;&lt; endl;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>51</code></td><td class="content"><code class="preprocessor">#endif</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>52</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>53</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>54</code></td><td class="content"><code class="preprocessor">#ifdef WIN32</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>55</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">closesocket(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>56</code></td><td class="content"><code class="preprocessor">#else</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>57</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">close(socketHandle);</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>58</code></td><td class="content"><code class="preprocessor">#endif</code></td></tr></tbody></table></div></div></div>
          </td>
        </tr>
      </tbody>
    </table>
Note that the declaration and error handling are different and platform 
dependent. The close() function call was made a little more specific for
 the Win32 platform.
</dd></dl>
<p>
</p>
Microsoft Visual C++ settings (VC5.0):
<dl><dd>
"Configuration Properties" --&gt; "C/C++" --&gt; "Preprocessor"
<br>
<img src="Sockets_files/SocketsVCPreprocessorDefinitions.gif" alt="Microsoft Visual C++ Preprocessor Definition settings for BSD sockets API">
<br>
Add: <tt>UTILSOCKETS_USE_IPC=0</tt>
</dd></dl>
<p>
<b>Error codes:</b> The error codes returned by the MS/Windows BSD API 
socket calls use different defined macro representations and may have to
 be handled differently.
</p>
<p>
<b>Config files:</b> MS/Windows has an equivalent of <tt>/etc/hosts</tt> which can be found in <tt>%SYSTEMROOT%\SYSTEM32\DIRVERS\ETC\HOSTS</tt> where the format is identical to the Unix/Linux file format.
</p>

<p>
</p>
<hr size="5">
<a name="MANPAGES"></a>
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Socket BSD API man pages:</td>
    </tr>
  </tbody>
</table>

<p>
</p>
Sockets API:
<ul>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=socket">socket</a>: establish socket interface
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=gethostname">gethostname</a>: obtain hostname of system
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=gethostbyname">gethostbyname</a>: returns a structure of type <tt>hostent</tt> for the given host name
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=bind&amp;cgi_section=2">bind</a>: bind a name to a socket
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=listen&amp;cgi_section=2">listen</a>: listen for connections on a socket
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=accept&amp;cgi_section=2">accept</a>: accept a connection on a socket
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=connect&amp;cgi_section=2">connect</a>: initiate a connection on a socket
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=setsockopt&amp;cgi_section=2">setsockopt</a>: set a particular socket option for the specified socket.
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=close&amp;cgi_section=2">close</a>: close a file descriptor
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=shutdown&amp;cgi_section=2">shutdown</a>: shut down part of a full-duplex connection
</li>
</ul>
<p>
</p>
Interrogate a socket:
<ul>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=select&amp;cgi_section=2">select</a>: synchronous I/O multiplexing
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=FD_SET&amp;cgi_section=2">FD_ZERO(), FD_CLR(), FD_SET(), FD_ISSET()</a>: Set socket bit masks
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=poll&amp;cgi_section=2">poll</a>:
 check on the state of a socket in a set of sockets. The set can be 
tested to see if any socket can be written to, read from or if an error 
occurred.
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=getsockopt&amp;cgi_section=2">getsockopt</a>: retrieve the current value of a particular socket option for the specified socket.
</li>
</ul>
<p>
</p>
Read/Write:
<ul>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=recv&amp;cgi_section=2">recv/recvfrom/recvmsg</a>: Read socket
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=send&amp;cgi_section=2">send/sendto/sendmsg</a>: Write socket
</li>
</ul>
<p>
</p>
Convert:
<ul>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=ntohl&amp;cgi_section=3">ntohl/htonl, ntohs/htons</a>: convert values between host and network byte order
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=inet_pton&amp;cgi_section=3">inet_pton</a>: Create a network address structure
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=inet_ntop&amp;cgi_section=3">inet_ntop</a>: Parse network address structures
</li>
</ul>
<p>
</p>
Other supporting system calls:
<ul>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=exit&amp;cgi_section=3">exit</a>: Terminate process
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=perror&amp;cgi_section=3">perror</a>: Output explanation of an error code
</li>
<li><a href="http://man.yolinux.com/cgi-bin/man2html?cgi_command=protocols&amp;cgi_section=5">protocols</a>: Network Protocols (see <tt>/etc/protocols</tt>)
</li>
</ul>
<p>
</p>
<hr size="5">
<a name="LINKS"></a>
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td>Links:</td>
    </tr>
  </tbody>
</table>
<p>
</p>
<ul>
<li><a href="http://www.yolinux.com/TUTORIALS/Endian-Byte-Order.html">Endian Byte Order tutorial</a> - YoLinux
</li>
<li><a href="http://apr.apache.org/">Apache Portable Runtime (APR)</a> - [<a href="http://apr.apache.org/docs/apr/">documentation</a>] - Portable socket wrapper functions.
</li>
<li><a href="http://tools.ietf.org/html/rfc4960">SCTP</a> - Stream Control Transmission Protocol
</li>
<li><a href="http://www.cs.cf.ac.uk/Dave/C/node33.html">RPC</a> - Remote Procedure Calls
</li>
<li><a href="http://www.ibm.com/developerworks/linux/library/l-openssl.html">IBM: Secure programming with the OpenSSL API</a>
</li>
</ul>
<p>
</p>
<a name="BOOKS"></a>
<hr size="5">
<table class="labelbar" border="0" cellpadding="2" cellspacing="0">
  <tbody>
    <tr>
      <td valign="top"><img src="Sockets_files/book40.gif"><b><big>Books:</big></b></td>
    </tr>
  </tbody>
</table>

    <p>
    </p>
    <dl>
    <dd>
    <table border="1" cellpadding="5">
    <tbody>
    
    <tr>
    <td><img src="Sockets_files/0131411551.jpg"></td>
    <td valign="top">
    "UNIX Network Programming, Volume 1: Sockets Networking API" <b>Third Edition</b>
    <br>
    by W. Richard Stevens, Bill Fenner, Andrew M. Rudoff, Richard W. Stevens
    <br>

    ISBN # 0131411551, Addison-Wesley Pub Co; 3 edition (October 22, 2003) 
    <p> This book covers POSIX, IPv6, network APIs, sockets
(elementary, advanced, routed, and raw), multicast, UDP, TCP, Threads,
Streams, ioctl. In depth coverage of topics. I recommend this book for any sockets programming task.</p>
    </td>
    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/0131411551/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>


    <tr>
    <td><img src="Sockets_files/013490012X.jpg"></td>
    <td valign="top">
    "UNIX Network Programming, Volume 1: Networking APIs - Sockets and XTI" <b>Second Edition</b>
    <br>
    by W. Richard Stevens
    <br>

    ISBN # 013490012X,  Prentice Hall PTR
    <p> This book covers network APIs, sockets + XTI,
multicast, UDP, TCP, ICMP, raw sockets, SNMP, MBONE. In depth coverage
of topics. </p>
    </td>
    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/013490012X/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>


    <tr>
    <td><img src="Sockets_files/0130810819.jpg"></td>
    <td valign="top">
    "UNIX Network Programming Volume 2: Interprocess Communications"
    <br>
    by W. Richard Stevens
    <br>
    ISBN # 0130810819, Prentice Hall PTR
    <p>

    This book covers semaphores, threads, record locking, memory mapped I/O,
    message queues, RPC's, etc.
    </p>
    </td>
    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/0130810819/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>

    <tr>
    <td><img src="Sockets_files/0123745403.jpg"></td>
    <td valign="top">
    TCP/IP Sockets in C, Second Edition: Practical Guide for Programmers
    <br>
    by Michael J. Donahoo, Kenneth L. Calvert
    <br>
    ISBN #0123745403
    <p>
    IPv4 and IPv6
    </p>
    </td>
    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/0123745403/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>

    <tr>
    <td><img src="Sockets_files/0735710430.jpg"></td>
    <td valign="top">
    "Advanced Linux Programming"
    <br>
    by Mark Mitchell, Jeffrey Oldham, Alex Samuel, Jeffery Oldham
    <br>
    ISBN # 0735710430, New Riders
    <p>
    Good book for programmers who already know how to program and just need
    to know the Linux specifics. Covers a variety of Linux tools, libraries,
    API's and techniques. If you don't know how to program, start with a
    book on C.
    </p>
    </td>

    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/0735710430/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>

    <tr>
    <td><img src="Sockets_files/0131411543.jpg"></td>
    <td valign="top">

    "Advanced UNIX Programming" <b>Second Edition</b>
    <br>
    by Marc J. Rochkind
    <br>
    ISBN # 0131411543,  Addison-Wesley Professional Computing Series
    <p>
    </p>
    </td>
    <td valign="top">

    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/0131411543/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>

    <tr>
    <td><img src="Sockets_files/0201563177.jpg"></td>
    <td valign="top">
    "Advanced Programming in the UNIX Environment" <b>First Edition</b>

    <br>
    by W. Richard Stevens
    <br>
    ISBN # 0201563177,  Addison-Wesley Professional Computing Series
    <p>
    It is the C programmers guide to programming on the UNIX platform. 
    This book is a must for any serious UNIX/Linux programmer. It covers all 
    of the essential UNIX/Linux API's and techniques.
    This book starts where the basic C programming book leaves off.
    Great example code.
    This book travels with me to every job I go to.
    </p>
    </td>
    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/0201563177/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>

    <br>
    </td>
    </tr>

    <tr>
    <td><img src="Sockets_files/067231990X.jpg"></td>
    <td valign="top">
    "Advanced Unix Programming"
    <br>
    by Warren W. Gay
    <br>

    ISBN # 067231990X, Sams White Book Series
    <p> This book covers all topics in general: files,
directories, date/time, libraries, pipes, IPC, semaphores, shared
memory, forked processes and I/O scheduling. The coverage is not as in
depth as the previous two books (Stevens Vol 1 and 2) </p>
    </td>
    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/067231990X/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>

    <tr>
    <td><img src="Sockets_files/0764546570.jpg"></td>
    <td valign="top">
    "Linux Programming Bible"
    <br>
    by John Goerzen
    <br>
    ISBN # 0764546570, Hungry Minds, Inc
    <p>
    This covers the next step after "C" programming 101.
    </p>

    </td>
    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/0764546570/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>

    <tr>
    <td><img src="Sockets_files/0131857576.jpg"></td>
    <td valign="top">
    C++ How to Program
    <br>
    by Harvey M. Deitel, Paul J. Deitel
    <br>
    ISBN #0131857576, Prentice Hall
    <p>
    Fifth edition.     The first edition of this book (and Professor 
Sheely at UTA) taught me to     program C++. It is complete and covers 
all the nuances of the C++ language.
    It also has good code examples. Good for both learning and 
reference.
    </p>
    </td>
    <td valign="top">
    <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http://www.amazon.com/exec/obidos/ASIN/0131857576/&amp;tag=yolinux-20"><img src="Sockets_files/Amazon-BuyABook88x31.gif" alt="Amazon.com"></a>
    <br>
    </td>
    </tr>

    </tbody>
    </table>
    </dd>
    </dl>
    <p>
    </p>
    </td>

    <td class="rightcol">
<!-- AddThis Button BEGIN -->
<div id="bookmark" align="left">
&nbsp;&nbsp;&nbsp;
<!-- Google +1: Place this tag where you want the +1 button to render -->
<div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; background: none repeat scroll 0% 0% transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 70px; height: 15px;"><iframe title="+1" data-gapiattached="true" src="Sockets_files/fastbutton.html" name="I0_1389172568583" id="I0_1389172568583" vspace="0" tabindex="0" style="position: static; top: 0px; width: 70px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 15px;" marginwidth="0" marginheight="0" hspace="0" width="100%" frameborder="0" scrolling="no"></iframe></div>
<br>
&nbsp;&nbsp;&nbsp;
<a href="http://www.addthis.com/bookmark.php?v=250&amp;pub=yolinux" onmouseover="return addthis_open(this, '', '[URL]', '[TITLE]')" onmouseout="addthis_close()" onclick="return addthis_sendto()"><img src="Sockets_files/lg-bookmark-en.gif" alt="Bookmark and Share" style="border:0" width="125" height="16"></a>
<script type="text/javascript" src="Sockets_files/addthis_widget.js">
</script><div id="_atssh" style="visibility: hidden; height: 1px; width: 1px; position: absolute; z-index: 100000;"><iframe src="Sockets_files/sh142.html" style="height: 1px; width: 1px; position: absolute; z-index: 100000; border: 0px none; left: 0px; top: 0px;" title="AddThis utility frame" id="_atssh367"></iframe></div><script src="Sockets_files/core114.js" type="text/javascript"></script>
</div>
<!-- AddThis Button END -->
<!-- Commission Junction START -->
<!--
<hr />
<p>
</p>
<div align="center">
<script type="text/javascript" language="javascript" src="http://www.jdoqocy.com/placeholder-6006807?target=_blank&mouseover=Y"></script>
</div>
-->
<!-- Commission Junction END -->
<p>
</p><hr>
<p></p>
<div align="center">
<p>
<font color="#505050">Advertisements</font>
</p>
<iframe class="adframe" allowtransparency="true" marginheight="0" marginwidth="0" style="border:none;width:160;height:600;padding:0;" src="Sockets_files/iframe160px-MediaDotNet.html" width="160" frameborder="0" height="600" scrolling="no">
</iframe>
</div>

<!-- Commission Junction START -->
<!--
<p>
</p>
<hr />
<div align="center">
<p>
<font color="#f0f0f0">Advertisement</font>
</p>
<b>Levono UK:</b>
<br />
<script type="text/javascript" language="javascript" src="http://www.jdoqocy.com/placeholder-5880661?target=_blank&mouseover=Y"></script>
</div>
-->
<!-- Commission Junction END -->

<p>
</p>
<hr>
<iframe src="Sockets_files/cm.html" marginwidth="0" marginheight="0" border="0" style="border:none;" width="160" frameborder="0" height="600" scrolling="no"></iframe>
<p>
</p>
<hr>
<p>
</p>
<script type="text/javascript">
<!-- 
var jobthread_widget_title = "Jobs";
var jobthread_widget_outer_style = "background-color:#dddddd;border:1px solid #999999;width:160px;";
var jobthread_widget_inner_style = "background-color:#ffffff;color:#666666;border:1px solid #999999;margin-left:10px;margin-right:10px;padding:10px 10px 2px 8px;font:11px Arial, Helvetica, Sans-serif;line-height:16px;";
var jobthread_widget_title_style = "color:#313131;font-weight:bold;";
var jobthread_widget_link_style = "color:#0464bb;font-size:11px;font-weight:normal;text-decoration:none;border:none;";
var jobthread_widget_top_style = "padding-top:8px;";
var jobthread_widget_bottom_style = "padding-bottom:4px;";
//-->
</script>
<script type="text/javascript" src="Sockets_files/a_002.html"></script>

<p>
</p>
<hr>
<p>
</p>

    <p>
    </p>

    </td>
    </tr>
  </tbody>
</table>
<div id="footer">
<table width="100%" background="Sockets_files/footer_pattern.png" bgcolor="#646664" cellpadding="4">
<tbody>
<tr>
<td valign="bottom">
<font size="-1" color="#ffcc33">
<b>
<a class="footer" href="http://www.yolinux.com/">YoLinux.com Home Page</a>
<br>
<a class="footer" href="http://www.yolinux.com/TUTORIALS/">YoLinux Tutorial Index</a> |
<a class="footer" href="http://www.yolinux.com/YoLinux-Terms.html">Terms</a>
<br>
<a class="footer" href="http://www.yolinux.com/privacy.html">Privacy Policy</a> |
<a class="footer" href="http://www.yolinux.com/YoLinux-Advertising.html">Advertise with us</a> | 
<a class="footer" href="http://www.yolinux.com/YoLinuxEmailForm.html">Feedback Form</a> |
<br>
Unauthorized copying or redistribution prohibited.
</b>
</font>
</td>
<td valign="bottom" align="center">
   <script src="Sockets_files/hostedbadge.html"></script><iframe id="iframe-stmblpn-widget-1" src="Sockets_files/a.html" style="overflow: hidden; margin: 0px; padding: 0px; border: 0px none;" allowtransparency="true" width="50" frameborder="0" height="60" scrolling="no"></iframe> <script type="text/javascript">   (function() {     var li = document.createElement('script'); li.type = 'text/javascript'; li.async = true;     li.src = window.location.protocol + '//platform.stumbleupon.com/1/widgets.js';     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(li, s);   })(); </script>
</td>
<td valign="bottom" align="center">
<!-- Place this tag where you want the +1 button to render -->
<div id="___plusone_1" style="text-indent: 0px; margin: 0px; padding: 0px; background: none repeat scroll 0% 0% transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 50px; height: 60px;"><iframe title="+1" data-gapiattached="true" src="Sockets_files/fastbutton_002.html" name="I1_1389172568592" id="I1_1389172568592" vspace="0" tabindex="0" style="position: static; top: 0px; width: 50px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 60px;" marginwidth="0" marginheight="0" hspace="0" width="100%" frameborder="0" scrolling="no"></iframe></div>
</td>
<td valign="bottom" align="center">
<script src="Sockets_files/buttons.js" type="text/javascript"></script>
<span class="db-wrapper db-clear db-medium"><span><span class="db-container db-submit"><span class="db-body db-medium"><span class="db-count"></span><span class="db-copy"></span><a class="db-anchor">digg</a></span></span></span></span>
</td>
<td valign="bottom" align="center">
<p>
</p>
<!-- AddThis Button BEGIN -->
<a href="http://www.addthis.com/bookmark.php?v=250&amp;pub=yolinux" onmouseover="return addthis_open(this, '', '[URL]', '[TITLE]')" onmouseout="addthis_close()" onclick="return addthis_sendto()"><img src="Sockets_files/lg-bookmark-en.gif" alt="Bookmark and Share" style="border:0" width="125" height="16"></a>
<script type="text/javascript" src="Sockets_files/addthis_widget.js">
</script>
<!-- AddThis Button END -->
</td>
<td valign="top">
<div align="right">
<font size="-1" color="#ffcc33"><a class="footer" href="#TOP">to top of page</a></font>
<br>
<script type="text/javascript"><!--
google_ad_client = "pub-8567479315106986";
/* 234x60, created 4/23/10 */
google_ad_slot = "8214196957";
google_ad_width = 234;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript" src="Sockets_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:60px;margin:0;padding:0;position:relative;visibility:visible;width:234px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:60px;margin:0;padding:0;position:relative;visibility:visible;width:234px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;" width="234" frameborder="0" height="60" scrolling="no"></iframe></ins></ins>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>
</p>

<small>Copyright © 2010 - 2013 by <i>Greg Ippolito</i></small>
<!-- Start Quantcast tag -->
<script type="text/javascript">
  var _qevents = _qevents || [];

  (function() {
   var elem = document.createElement('script');

   elem.src = (document.location.protocol == "https:" ? "https://secure" : "http://edge") + ".quantserve.com/quant.js";
   elem.async = true;
   elem.type = "text/javascript";
   var scpt = document.getElementsByTagName('script')[0];
   scpt.parentNode.insertBefore(elem, scpt);  
  })();
</script>
<script type="text/javascript">
_qevents.push( { qacct:"p-ebIBcaVUngFBQ"} );
</script>
<noscript>
<div style="display: none;"><img src="//pixel.quantserve.com/pixel/p-ebIBcaVUngFBQ.gif" height="1" width="1" alt="Quantcast"/></div>
</noscript>
<!-- End Quantcast tag -->


<!-- Start Google +1 tag -->
<!-- Place this tag in your head or just before your close body tag -->
<script gapi_processed="true" type="text/javascript" src="Sockets_files/plusone.js"></script>
<!-- End Google +1 tag -->


<!-- Start Google Analytics tag -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="Sockets_files/ga.js" type="text/javascript"></script><iframe style="width: 1px; height: 1px; position: absolute; top: -100px;" src="Sockets_files/postmessageRelay.html" id="oauth2relay860921237" name="oauth2relay860921237"></iframe>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3317450-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
<!-- End Google Analytics tag -->




</body></html>