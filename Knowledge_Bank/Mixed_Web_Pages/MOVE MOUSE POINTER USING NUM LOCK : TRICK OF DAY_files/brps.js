google.load("jquery","1");google.setOnLoadCallback(function(){var a=jQuery,b=window.brps_options||{};if(b.autoload)BRPS_get();else{a("#related_posts").empty();BRPS_render_widget_title();a("#related_posts").append(a("<button/>").text(b.load_button_text||"Click to load related posts list").click(BRPS_get))}});
function BRPS_watchdog(){if(window.brps_start!=undefined){diff=(new Date).valueOf()-brps_start;if(diff>=3E4){$("#related_posts").empty();BRPS_render_widget_title();$("#related_posts").append('<p style="color:#f00">Something went wrong with BRPS server!</p>');window.brps_start=undefined}else window.setTimeout("BRPS_watchdog()",5E3)}}
function BRPS_render_widget_title(){var a=jQuery,b=window.brps_options;b&&b.title?a(b.title).appendTo("#related_posts"):a("<h2>Related Posts</h2>").appendTo("#related_posts")}
function BRPS_get(){var a=jQuery;if(a("script[src*='brps.appspot.com/brps.js']").length!=1)a("#related_posts").empty().html("<p>Could not find the possible script tags, you can only include BRPS client brps.js script once.</p>");else{var b=a("script[src*='brps.appspot.com/brps.js']")[0].src,c=b.match(/.*brps\.js\?key=(\w{8})/),k="";if(c!=null)k=c[1];var n=b.substring(0,b.indexOf("brps.js")),f=window.brps_options,g="";g=/.*blogID=(\d+)/.exec(a(a("link[rel='EditURI']")[0]).attr("href"))[1];for(var l=
a("link[rel='alternate']"),h="",i=0;i<l.length;i++){c=/.*\/feeds\/(\d+)\/comments\/default/.exec(a(l[i]).attr("href"));if(c!=null)if(c.length==2){h=c[1];break}}if(g!=""&&h!=""){window.brps_start==undefined&&window.setTimeout("BRPS_watchdog()",5E3);window.brps_start=(new Date).valueOf();a("#related_posts").empty();BRPS_render_widget_title();a("<i>Loading...</i>").appendTo("#related_posts");max_results=f&&f.max_results?"&max_results="+f.max_results.toString():"";a.getJSON(n+"get?blog="+g+"&post="+h+
"&key="+k+max_results+"&callback=?",function(e){window.brps_start=undefined;var d=jQuery,m=window.brps_options;d("#related_posts").empty();BRPS_render_widget_title();if(e.error){d("<p>"+e.error+"</p>").appendTo("#related_posts");e.code==3&&window.setTimeout("BRPS_get()",5E3)}else if(e.entry.length>0){b=m&&m.append_src?"?src=brps":"";d("<ul></ul>").appendTo("#related_posts");d.each(e.entry,function(o,j){d('<li><a href="'+j.link+b+'" title="Score: '+j.score.toString()+'">'+j.title+"</a></li>").appendTo("#related_posts ul").hide().animate({height:"toggle",
opacity:"toggle"},"slow")})}else d("<p>No related posts found.</p>").appendTo("#related_posts")})}}};
