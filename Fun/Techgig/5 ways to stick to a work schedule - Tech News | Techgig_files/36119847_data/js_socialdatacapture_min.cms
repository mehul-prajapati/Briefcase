if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){for(var b=(d||0),a=this.length;b<a;b++){if(this[b]===c){return b}}return -1}}var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null
};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;
return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";
case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)
}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")
}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)
})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());var socialDataCapture=(function(){var d=document,b=d.body,de=d.documentElement,C=eval("/*@cc_on!@*/false"),loginUserData={dataCaptured:[],capturedData:[]},AttachEvent,RemoveEvent,getDateCount=0,config={urls:{socialDataCapture:{domain:{local:"http://ua.economictimes.indiatimes.com/profiles",live:"http://ua.economictimes.indiatimes.com/profiles",url:""},service:"/socalDataInsert.spring",currDT:"/curdate.spring"},serverDateTime:{service:"/serverdatetime_dc.cms"},deviceTracking:{domain:{local:"http://192.168.27.75:9090",live:"http://ua.economictimes.indiatimes.com",url:""},service:"/ualogging/ualogger.spring?serviceid=2&appid=1&callback=?",enabled:true},autosubscribeWealthNewsletter:{domain:{local:"http://192.168.27.75:9090",live:"http://alerts.economictimes.com",url:""},service:"/UserRegistration/alerts/subscribeNewsletter/?serviceId=28",enabled:true},allowedDomains:["economictimes.indiatimes.com","etportfolio.economictimes.indiatimes.com"]},socialDataCaptureFields:["username","MSCSAuthID","MSCSAuthDetail","MSCSAuthDetails","FB","LNKD"],facebook:{enabled:true,profileURL:function(){return"https://graph.facebook.com/me?access_token="+loginUserData.facebookKey+"&callback=socialDataCapture.dtcpfbCallback"
},profileCallCompleteFlag:true,refreshTime:15},linkedin:{enabled:true,profileURL:function(fields){return"https://api.linkedin.com/v1/people/~:("+fields.toString()+")?oauth2_access_token="+loginUserData.linkedinKey+"&callback=socialDataCapture.dtcplnkdCallback"},profileFields:["email-address","id","first-name","last-name","maiden-name","formatted-name","phonetic-first-name","phonetic-last-name","formatted-phonetic-name","headline","location:(name,country:(code))","industry","distance","relation-to-viewer:(distance)","current-share","num-connections","num-connections-capped","summary","specialties","positions","picture-url","site-standard-profile-request","api-standard-profile-request:(url,headers)","public-profile-url","last-modified-timestamp","proposal-comments","associations","interests","publications","patents","languages","skills","certifications","educations","courses","volunteer","three-current-positions","three-past-positions","num-recommenders","recommendations-received","mfeed-rss-url","following","job-bookmarks","suggestions","date-of-birth","member-url-resources","related-profile-views","honors-awards","phone-numbers","bound-account-types","im-accounts","main-address","twitter-accounts","primary-twitter-account","connections","group-memberships","network"],fieldsProcessCount:0,fieldsProcessStep:10,profileCallCompleteFlag:true,refreshTime:15}},CaptureReadyState=function(a){SetEvent();
d.readyState=="complete"?a():AttachEvent(window,"load",function(){setTimeout(function(){if(typeof d.readyState=="undefined"&&!C){d.readyState="complete"}a()},10)})},SetServiceDomain=function(){if(config.urls.allowedDomains.indexOf(window.location.host)==-1){config.urls.socialDataCapture.domain.url=config.urls.socialDataCapture.domain.local;config.urls.deviceTracking.domain.url=config.urls.deviceTracking.domain.local;config.urls.autosubscribeWealthNewsletter.domain.url=config.urls.autosubscribeWealthNewsletter.domain.local
}else{config.urls.socialDataCapture.domain.url=config.urls.socialDataCapture.domain.live;config.urls.deviceTracking.domain.url=config.urls.deviceTracking.domain.live;config.urls.autosubscribeWealthNewsletter.domain.url=config.urls.autosubscribeWealthNewsletter.domain.live}},SetEvent=function(){if(window.addEventListener){AttachEvent=function(a,b,c){a.addEventListener(b,c,false)};RemoveEvent=function(a,b,c){a.removeEventListener(b,c,false)}}else{AttachEvent=function(a,b,c){a.attachEvent("on"+b,c)};
RemoveEvent=function(a,b,c){a.detachEvent("on"+b,c)}}},SetProperty=function(a,b){for(var c in a){if(a.hasOwnProperty(c)){b[c]=a[c]}}},BuildObject=function(a,b,c){a=d.createElement(a);SetProperty(b,a);SetProperty(c,a.style);return a},init=function(){SetServiceDomain();getLoginUserDetails();if(loginUserData.loginFlag){if(config.urls.deviceTracking.enabled){AJAX(config.urls.deviceTracking.domain.url+config.urls.deviceTracking.service+"&emailid="+loginUserData.username)}if(config.urls.autosubscribeWealthNewsletter.enabled){var wealthsubcriptionCookie=COOKIE("_etws");
if(!wealthsubcriptionCookie||wealthsubcriptionCookie!=loginUserData.username){var sur=loginUserData.username,callFlag=true,lu=loginUserData.username;if(lu.indexOf("@indiatimes.com")!=-1){var udts=loginUserData.MSCSAuthDetails["UserName"];udts=(udts.indexOf("@")==-1)?udts+"@indiatimes.com":udts;var udt=loginUserData.MSCSAuthDetail["Email"];udt=(udt.indexOf("@")==-1)?udt+"@indiatimes.com":udt;sur="";if(udts&&udt&&(udt.indexOf("@indiatimes.com")==-1)&&((udts==lu)!=udt)){sur=udt}else{if(udts&&udt&&(udts.indexOf("@indiatimes.com")==-1)&&((udt==lu)!=udts)){sur=udts
}else{callFlag=false}}}if(callFlag&&sur){loginUserData.subscribed_username=sur;AJAX(config.urls.autosubscribeWealthNewsletter.domain.url+config.urls.autosubscribeWealthNewsletter.service+"&ssoid="+loginUserData.subscribed_username+"&callback=socialDataCapture.autosubwCallback")}}}var dtcpVal=COOKIE("dtcpet"+loginUserData.username.replace("@",""));if(dtcpVal){var temp=[],cnt=0;if(dtcpVal.indexOf("~")!=-1){temp=dtcpVal.split("~")}else{temp.push(dtcpVal)}loginUserData.capturedData=temp;for(var r=0;r<temp.length;
r++){if((temp[r].indexOf("FB")!=-1)&&config.facebook.enabled){cnt=cnt+1;getDateTime("FB",temp[r])}else{if((temp[r].indexOf("LNKD")!=-1)&&config.linkedin.enabled){cnt=cnt+1;getDateTime("LNKD",temp[r])}}}if(config.facebook.enabled&&!cnt){loginUserData.FBflag=true;loginProceed("FB")}if(config.linkedin.enabled&&!cnt){loginUserData.LNKDflag=true;loginProceed("LNKD")}}else{if(config.facebook.enabled){loginUserData.FBflag=true;loginProceed("FB")}if(config.linkedin.enabled){loginUserData.LNKDflag=true;loginProceed("LNKD")
}}}},loginProceed=function(idd){if(loginUserData.FBflag&&(idd&&idd=="FB")){var Fbskey=COOKIE("Fbsecuritykey");if(Fbskey){config.facebook.profileCallCompleteFlag=false;loginUserData.facebookKey=Fbskey;var fbUrl=config.facebook.profileURL();AJAX(fbUrl)}}if(loginUserData.LNKDflag&&(idd&&idd=="LNKD")){var LinkedSKey=COOKIE("LnSecurityKey");if(LinkedSKey){config.linkedin.profileCallCompleteFlag=false;loginUserData.linkedinKey=LinkedSKey;linkedProfileCall()}}},getDateTime=function(idd,captureTime){var CallTime=captureTime.replace(idd+"#","");
if(CallTime.indexOf(",")!=-1){var temp1=CallTime.split(",");var dtObj={};dtObj.hr=temp1[1].substring(0,2);dtObj.mt=temp1[1].substring(2,4);if(temp1[0].indexOf(".")!=-1){var temp2=temp1[0].split(".");dtObj.dd=temp2[0];dtObj.mm=temp2[1];dtObj.yy=temp2[2]}var obj=dtObj;if(obj.dd&&obj.mm&&obj.yy&&obj.hr&&obj.mt){var dt=new Date(obj.yy,obj.mm,obj.dd,obj.hr,obj.mt,0,0);loginUserData[idd+"FetchTime"]=dt.getTime();getCurrentDateTime(idd)}}},getCurrentDateTime=function(idd){getDateCount=getDateCount+1;if(getDateCount<2){getServerDateTime(getCurrDTResponse,{idd:idd})
}else{checkRefreshTime(idd)}},getCurrDTResponseFB=function(data){getCurrDTResponse(data,"FB")},getCurrDTResponseLNKD=function(){getCurrDTResponse(data,"LNKD")},getCurrDTResponse=function(data,prm){if(data&&data.indexOf(",")!=-1){var temp1=data.split(",");var dtObj={};dtObj.hr=temp1[1].substring(0,2);dtObj.mt=temp1[1].substring(2,4);if(temp1[0].indexOf(".")!=-1){var temp2=temp1[0].split(".");dtObj.dd=temp2[0];dtObj.mm=temp2[1];dtObj.yy=temp2[2]}var obj=dtObj;if(obj.dd&&obj.mm&&obj.yy&&obj.hr&&obj.mt){var dt=new Date(obj.yy,obj.mm,obj.dd,obj.hr,obj.mt,0,0);
loginUserData.currDT=dt.getTime()}}checkRefreshTime(prm.idd)},checkRefreshTime=function(idd){if(((idd=="FB")&&((loginUserData.currDT-loginUserData[idd+"FetchTime"])/(24*60*60*1000)>config.facebook.refreshTime))||((idd=="LNKD")&&((loginUserData.currDT-loginUserData[idd+"FetchTime"])/(24*60*60*1000)>config.linkedin.refreshTime))){loginUserData[idd+"flag"]=true}else{loginUserData[idd+"flag"]=false}loginProceed(idd)},linkedProfileCall=function(){var temp=[],startCount=parseInt(config.linkedin.fieldsProcessCount,10),step=parseInt(config.linkedin.fieldsProcessStep,10),endCount=(startCount+step);
endCount=(endCount<(config.linkedin.profileFields.length-1))?endCount:(config.linkedin.profileFields.length-1);for(var x=startCount;x<endCount;x++){config.linkedin.fieldsProcessCount=startCount+1;temp.push(config.linkedin.profileFields[x])}var lkdURL=config.linkedin.profileURL(temp);AJAX(lkdURL)},dtcpfbCallback=function(data){if(data&&(decodeURIComponent(data.email)==loginUserData.username)){loginUserData.FB=data;config.facebook.profileCallCompleteFlag=true;loginUserData.dataCaptured.push("FB");postCaptureData()
}},dtcplnkdCallback=function(data){if(data&&(decodeURIComponent(data.emailAddress)==loginUserData.username)){if(loginUserData.LNKD){for(var x in data){loginUserData.LNKD[x]=data[x]}}else{loginUserData.LNKD=data}}if((data.emailAddress==loginUserData.username)&&parseInt(config.linkedin.fieldsProcessCount)<(config.linkedin.profileFields.length-1)){linkedProfileCall()}else{config.linkedin.profileCallCompleteFlag=true;loginUserData.dataCaptured.push("LNKD");postCaptureData()}},postCaptureData=function(){if(config.linkedin.profileCallCompleteFlag&&config.facebook.profileCallCompleteFlag){drawPostingForm(config.socialDataCaptureFields);
DOM("socialDataCapture").submit()}},socialDataCaptureResponse=function(data){if(data.status=="success"){getServerDateTime(socialDataCaptureStore)}},socialDataCaptureStore=function(dd){var val="";for(x=0;x<loginUserData.dataCaptured.length;x++){var indx=loginUserData.capturedData.indexOf(loginUserData.dataCaptured[x]);if(indx==-1){loginUserData.capturedData.push((loginUserData.dataCaptured[x])+"#"+dd)}else{loginUserData.capturedData.splice(indx,1);loginUserData.capturedData.push((loginUserData.dataCaptured[x])+"#"+dd)
}}val=(loginUserData.capturedData).join("~");COOKIE("dtcpet"+(loginUserData.username.replace("@","")),val,{expires:(30*24*60*60*1000),path:"/",domain:".indiatimes.com"})},getServerDateTime=function(callback,params){AJAX(config.urls.serverDateTime.service,callback,params)},drawPostingForm=function(dataFields){var obj,ifrme='<iframe name="i_socialDataCapture" id="i_socialDataCapture" style="display:none"></iframe>';formObj=BuildObject("form",{method:"post",action:config.urls.socialDataCapture.domain.url+config.urls.socialDataCapture.service,name:"socialDataCapture",id:"socialDataCapture",target:"i_socialDataCapture"},{display:"none"});
var dvv=BuildObject("div",{name:"dvv_i_socialDataCapture",id:"dvv_i_socialDataCapture"},{display:"none"});document.body.appendChild(dvv);DOM("dvv_i_socialDataCapture").innerHTML=ifrme;for(var m in loginUserData){if(dataFields.indexOf(m)!=-1){obj=BuildObject("input",{type:"hidden",name:m,value:JSON.stringify(loginUserData[m])},{});formObj.appendChild(obj)}}obj=BuildObject("input",{type:"hidden",name:"callback",value:"socialDataCapture.socialDataCaptureResponse"},{});formObj.appendChild(obj);if(DOM("socialDataCapture")){REMOVE("socialDataCapture")
}document.body.appendChild(formObj)},getLoginUserDetails=function(){var isLogged1=COOKIE("MSCSAuth");var username="";if(isLogged1){loginUserData.MSCSAuthDetails=getCookieValue("MSCSAuthDetails");loginUserData.MSCSAuthDetail=getCookieValue("MSCSAuthDetail");if(loginUserData.MSCSAuthDetails&&loginUserData.MSCSAuthDetails!="null"&&loginUserData.MSCSAuthDetails["UserName"]&&loginUserData.MSCSAuthDetails["UserName"]!="null"){username=loginUserData.MSCSAuthDetails["UserName"]}else{if(loginUserData.MSCSAuthDetail&&loginUserData.MSCSAuthDetail!="null"&&loginUserData.MSCSAuthDetail["Email"]&&loginUserData.MSCSAuthDetail["Email"]!="null"){username=loginUserData.MSCSAuthDetail["Email"]
}}if(username&&username.indexOf("@")==-1){username=username+"@indiatimes.com"}if(username){var reg1=/['";,]/ig;username=username.replace(reg1,"");loginUserData.loginFlag=true;loginUserData.username=username;loginUserData.MSCSAuthID=getCookieValue("MSCSAuthID")}}else{if(window.location.search.indexOf("email=")!=-1){var srch=window.location.search,temp=[],data={};srch=srch.substring(1,srch.length);if(srch.indexOf("&")!=-1){temp=srch.split("&")}else{temp.push(srch)}var temp2=[];for(var i=0;i<temp.length;
i++){temp2=srch.split("=");data[temp2[0]]=data[temp2[1]]}loginUserData.searchParams=data}}},getCookieValue=function(name){var cook=COOKIE(name),data={};var temp=[];if(cook){if(cook.indexOf("~")!=-1){temp=cook.split("~")}else{temp.push(cook)}for(x=0;x<temp.length;x++){if(temp[x].indexOf("=")!=-1){var temp1=temp[x].split("=");var val=cleanData(temp1[1]);data[temp1[0]]=val}else{data=temp[x]}}}else{data=""}return data},COOKIE=function(name,value,options){if(typeof value!="undefined"||(name&&typeof name!="string")){if(typeof name=="string"){options=options||{};
if(value===null){value="";options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date();date.setTime(date.getTime()+options.expires)}else{date=options.expires}expires="; expires="+date.toUTCString()}var path=options.path?"; path="+(options.path):"";var domain=options.domain?"; domain="+(options.domain):"";var secure=options.secure?"; secure":"";d.cookie=name+"="+encodeURIComponent(value)+expires+path+domain+secure
}else{for(var n in name){userProfiling.COOKIE(n,name[n],value||options)}}}else{var returnValue="";if(d.cookie){var cookies=d.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=cookies[i].trim();if(!name){var nameLength=cookie.indexOf("=");returnValue[cookie.substr(0,nameLength)]=decodeURIComponent(cookie.substr(nameLength+1))}else{if(cookie.substr(0,name.length+1)==(name+"=")){returnValue=decodeURIComponent(cookie.substr(name.length+1));break}}}}return returnValue}},AJAX=function(url,callback,params){var dt=new Date();
url=(url.indexOf("?")==-1)?url+"?_"+dt.getTime():url+"&_"+dt.getTime();if(url.indexOf("callback=")==-1){ajaxCallBack(url,function(){if(this.readyState==4&&this.status==200){if(callback){if(params){callback(this.responseText,params)}else{callback(this.responseText)}}}})}else{var NewScript=d.createElement("script");NewScript.type="text/javascript";NewScript.src=url+"&_"+Math.random();d.getElementsByTagName("head")[0].appendChild(NewScript)}},ajaxCallBack=function(url,callback){var xmlhttp;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()
}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.onreadystatechange=callback;xmlhttp.open("GET",url,true);xmlhttp.send()},DOM=function(id){return d.getElementById(id)},REMOVE=function(id){var elem=DOM(id);elem.parentNode.removeChild(elem)},cleanData=function(data){var x="";if(data&&data!="null"){x=data}return x},autosubwCallback=function(d){COOKIE("_etws",loginUserData.username,{expires:(7*24*60*60*1000),path:"/",domain:".indiatimes.com"})};return{CaptureReadyState:CaptureReadyState(init),dtcpfbCallback:dtcpfbCallback,dtcplnkdCallback:dtcplnkdCallback,socialDataCaptureResponse:socialDataCaptureResponse,getCurrDTResponseFB:getCurrDTResponseFB,getCurrDTResponseLNKD:getCurrDTResponseLNKD,autosubwCallback:autosubwCallback}
})();